"use strict";function resetTimer(e){idleTime=0}function timerIncrement(){idleTime+=1,idleTime>59&&window.location.replace(globalDataInteractionObj.objectProperties.appLogout)}var quiz={},monthly_focus={},g2={},freshMapObject=null,watchPopupClose=null,idleInterval=null,resizer=null,resizer2=null;monthly_focus.child=!1,monthly_focus.class_link=!1,monthly_focus.child_has_been_opened=!1;var globalDataInteractionObj={isMapLoaded:!1,objectProperties:{forcePath:!1,isIPad:null!=navigator.userAgent.match(/iPad/i),appRoot:site_url,appLogout:site_logout,apiRequestParam:exp_actions.elan_api_request,apiUserId:member_profile_data.elan_user_id,apiUserName:member_profile_data.elan_username,apiUserLanguage:{id:1,name:"English",tag:"English",abbreviation:"en"},handlebarsDomMap:{"course-detail-overlay":"course-detail","course-data-summary-template":"course-data-container","map-info-template":"map-info","quiz-modal":"quiz-container"},ajaxContentHeightValue:0,viewportHeight:document.documentElement.clientHeight,pageToggleElements:["journey-main-menu","translator-icon","slider-top","slider-map"],rawAjaxUserData:null,rawAjaxCourseData:null,rawAjaxItineraryData:null,rawAjaxCourseDetailData:null,translations:null},utilities:{truncateString:function(string){if(string.length>37){var trimmedString=string.substring(0,37);return string.substr(0,Math.min(trimmedString.length,trimmedString.lastIndexOf(" ")))+"..."}return string},toProperCase:function(str){var noCaps=["of","a","the","and","an","am","or","nor","but","is","if","then","else","when","from","by","on","off","for","in","out","to","into","with"],capExceptions=["slgs"];return str.replace(/\w\S*/g,function(txt,offset){return 0!=offset&&-1!=noCaps.indexOf(txt.toLowerCase())?txt.toLowerCase():0!=offset&&-1!=capExceptions.indexOf(txt.toLowerCase())?txt.toUpperCase():txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})},createClassName:function(obj){var str="string"!=typeof obj?obj.toString():obj;return str.toLowerCase().trim().replace(/ /g,"-").replace(/,-/g," ")},getCountryCode:function(){return member_profile_data.country_code},getLocationIP:function(){return member_profile_data.location_ip},getCookie:function(cname){for(var name=cname+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(name))return c.substring(name.length,c.length)}return""},lang:function(key){var translations=globalDataInteractionObj.objectProperties.translations,text=key;return translations&&translations.hasOwnProperty(key)&&(text=translations[key]),text},setAllowedLanguages:function(elementClass,bindLanguageLinks){$.each(elanLanguages,function(key,langObject){var langLink="";langLink=1==langObject.id?'<a class="btn change-language selected" attr-lang-id="'+langObject.id+'" attr-lang-abbr="'+langObject.abbreviation+'">'+langObject.name+"</a>":'<a class="btn change-language" attr-lang-id="'+langObject.id+'" attr-lang-abbr="'+langObject.abbreviation+'">'+langObject.name+"</a>",$("div."+elementClass).append(langLink)}),"function"==typeof bindLanguageLinks&&bindLanguageLinks()},setProgressionCircleParameters:function(jqElemIn){var circleObj={};return circleObj.elemRadius=parseInt(jqElemIn.attr("r")),circleObj.elemCircumference=Math.round(2*Math.PI*circleObj.elemRadius),circleObj.elemRatio=circleObj.elemCircumference/100,circleObj},escapeXml:function(string){return string.replace(/[<>]/g,function(c){switch(c){case"<":return"<";case">":return">"}})},findIndexByProperty:function(records,propertyName,propertyValue){return records.findIndex(function(element){return element[propertyName]==propertyValue})},findOneByProperty:function(records,propertyName,propertyValue,recordType){return records.length>0?"undefined"!=typeof recordType&&"AREA"==recordType?records.filter(function(element){return element[propertyName]==propertyValue&&0==element.parent_id})[0]||null:"undefined"!=typeof recordType&&"NEIGHBORHOOD"==recordType?records.filter(function(element){return element[propertyName]==propertyValue&&0!=element.parent_id})[0]||null:records.filter(function(element){return element[propertyName]==propertyValue})[0]||null:null},findAllByProperty:function(records,propertyName,propertyValue){return records.filter(function(element){return element[propertyName]==propertyValue})||null},sortByProperty:function(records,propertyName){return records.sort(function(a,b){return a[propertyName]>b[propertyName]})||null},findJourneyMap:function(records,mapTagName){return records.filter(function(r){var tags=$.map(r.TAGS.split(","),$.trim);return r.OBJECT_TYPE_ID==elanObjects.success_track.id&&-1!=tags.indexOf(mapTagName)})[0]||null},findMapArea:function(records,areaName){return areaName="EU"==globalDataInteractionObj.mapInteractionHandler.currentMap?areaName:areaName+" Area",records&&"function"==typeof records.filter?records.filter(function(r){return(r.OBJECT_TYPE_ID==elanObjects.scorm.id||r.OBJECT_TYPE_ID==elanObjects.success_track.id||r.OBJECT_TYPE_ID==elanObjects.curriculum.id)&&-1!=r.TAGS.indexOf(areaName)})[0]||null:void 0},findMapNeighborhood:function(records,neighborhoodTagName){return records.filter(function(r){var tags=$.map(r.TAGS.split(","),$.trim);return r.OBJECT_TYPE_ID==elanObjects.scorm.id&&-1!=tags.indexOf(neighborhoodTagName)})[0]||null},findMapNeighborhoodAssessment:function(records,neighborhoodTagName){return records.filter(function(r){var tags=$.map(r.TAGS.split(","),$.trim);return r.OBJECT_TYPE_ID==elanObjects["class"].id&&-1!=tags.indexOf(neighborhoodTagName)})[0]||null},launchMonthlyFocusCourse:function(learningObjectId,learningObjectParentId){var learningObject={};learningObject.OBJECT_ID=learningObjectId,learningObject.OBJECT_PARENT_IDS=learningObjectParentId,globalDataInteractionObj.utilities.launchScormCourse(learningObject)},launchNeighborhoodCourse:function(learningObjectId){var learningObject={};learningObject="undefined"==typeof learningObjectId||null==learningObjectId?globalDataInteractionObj.mapInteractionHandler.currentMapObject:globalDataInteractionObj.utilities.findOneByProperty(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,"OBJECT_ID",learningObjectId),globalDataInteractionObj.utilities.launchScormCourse(learningObject)},launchScormCourse:function(learningObject){var handleUserObjectRecord=function(userObjectRecord){if(userObjectRecord){var parameters={};parameters={type:"launchscorm",object_id:learningObject.OBJECT_ID,record_id:userObjectRecord.RECORD_ID},$.ajax(globalDataInteractionObj.ajaxUtilities.ajaxSwitch("GET",parameters,"api")).done(function(response){if(response.hasOwnProperty("DATA")){var poptions="scrollbars=0,directories=0,location=0,menubar=0,toolbar=0,status=0,width=1024,height=768";coursePopup&&!coursePopup.closed?coursePopup.focus():(coursePopup=window.open(response.DATA.LAUNCH_URL,"coursePopup",poptions),coursePopup?$(coursePopup).on("unload",globalDataInteractionObj.utilities.scormUnload):alert("We launched your course in a new window but if you do not see it, a popup blocker may be preventing it from opening. Please disable popup blockers for this site."))}})}else globalDataInteractionObj.userData.createUserObjectRecord(learningObject,handleUserObjectRecord)};("undefined"!=typeof learningObject.OBJECT_ID||null!=learningObject.OBJECT_ID)&&globalDataInteractionObj.userData.fetchUserObjectRecord(learningObject.OBJECT_ID,handleUserObjectRecord)},scormUnload:function(){watchPopupClose&&clearInterval(watchPopupClose),watchPopupClose=setInterval(function(){coursePopup.closed&&(clearInterval(watchPopupClose),$("a#mapCallToAction").css("pointer-events","auto"),globalDataInteractionObj.userData.update())},500)}},closeMenu:function(){$("body").removeClass("no-scroll"),$("#off-canvas-menu").hide("slow"),$("#menu-dimmer").hide("slow")},ajaxUtilities:{loading:function(element){},ajaxSwitch:function(requestType,params,callSource,localCallSource){localCallSource=localCallSource||null,"usercoursedata"==localCallSource?(localCallSource=globalDataInteractionObj.userData.isRetailOrOutlet()+"/"+localCallSource,params={type:"getmonthlyfocus"}):"userdata"==localCallSource?params={type:"userinfowithattr"}:"useritinerary"==localCallSource&&(params={type:"getmonthlyfocusitinerary"});var propInstance=globalDataInteractionObj.objectProperties,objOut={};switch(objOut.type=requestType,objOut.dataType="json",callSource){case"api":objOut.url=propInstance.appRoot,objOut.data={ACT:propInstance.apiRequestParam},$.each(params,function(key,value){objOut.data[key]=encodeURIComponent(value)}),"undefined"==typeof objOut.data.user_id&&(objOut.data.user_id=propInstance.apiUserId);break;default:objOut.url="js/test-data/"+localCallSource+".json"}return objOut},ajaxLauncher:function(typeIn,courseId,parentId,questionId,stepNum){courseId=courseId||null;var callParams={};switch(callParams.httpRequestType="GET",callParams.dataPoints=null,callParams.dataSource="api",callParams.dataResponse=null,callParams.detailId=courseId,typeIn){case"userdata":callParams.sequenceRunner=function(dataIn){globalDataInteractionObj.objectProperties.rawAjaxUserData=dataIn,globalDataInteractionObj.userData.setUserLanguage(),globalDataInteractionObj.courseData.courseInit()};break;case"usercoursedata":callParams.sequenceRunner=function(dataIn){globalDataInteractionObj.objectProperties.rawAjaxCourseData=dataIn,globalDataInteractionObj.objectProperties.translations=dataIn.translations,globalDataInteractionObj.userData.setLanguageCommonTerms(),globalDataInteractionObj.ajaxUtilities.runCourseAjaxSequence(),globalDataInteractionObj.ajaxUtilities.ajaxLauncher("useritinerary"),$("#site-nav").show(),$(".translator-icon").show()};break;case"useritinerary":callParams.sequenceRunner=function(dataIn){globalDataInteractionObj.objectProperties.rawAjaxItineraryData=dataIn,globalDataInteractionObj.ajaxUtilities.runUserAjaxSequence()};break;case"coursedetaildata":callParams.sequenceRunner=function(dataIn,courseId){globalDataInteractionObj.objectProperties.rawAjaxCourseDetailData=dataIn},callParams.dataPoints={type:"coursedetaildata",object_id:courseId,children:parentId};break;case"coursedetaillink":callParams.dataPoints={type:"coursedetaillink",object_id:courseId,parent_object_id:parentId};break;case"updateuserobjectrecord":callParams.dataPoints={type:"updateuserobjectrecord",record_id:courseId,status:parentId,score:questionId};break;case"getquizquestions":callParams.dataPoints={type:"getquizquestions",object_id:courseId,parent_object_id:parentId};break;case"submitquizanswers":callParams.dataPoints={type:"submitquizanswers",record_id:courseId,user_ans_no:parentId,question_id:questionId};break;case"getcoursevideo":callParams.dataPoints={type:"getcoursevideo",record_id:courseId,step_num:stepNum,object_id:questionId,parent_object_id:parentId};break;case"updatecreateuserrecord":callParams.dataPoints={type:"updatecreateuserrecord",object_id:courseId,parent_object_id:parentId,status:questionId},(questionId="Complete")&&globalDataInteractionObj.ajaxUtilities.removeDisableClassForNextChild(courseId,parentId);break;case"mapsetup":globalDataInteractionObj.closeMenu();var mlRankMap=arguments[1]||globalDataInteractionObj.userData.mlRankMap();if(console.log("----------- which map? -----------",arguments),freshMapObject&&"function"==typeof freshMapObject.reset){var mapDiv=jQuery("#vmap");mapDiv.empty(),freshMapObject.reset()}globalDataInteractionObj.userData.setUserMapHandler(function(mlRankMap){"mlapprentice"==mlRankMap?globalDataInteractionObj.userData.userMapHandler=mlApprenticeConfig:"mlambassador"==mlRankMap?globalDataInteractionObj.userData.userMapHandler=mlAmbssadorConfig:"eu"==mlRankMap&&(globalDataInteractionObj.userData.userMapHandler=euConfig),globalDataInteractionObj.userData.setUserMapLanguage(mlRankMap),globalDataInteractionObj.mapInteractionHandler.mapInit(mlRankMap),globalDataInteractionObj.interactionHandler.subInit(mlRankMap),globalDataInteractionObj.mapInteractionHandler.resetMapThen(mlRankMap)},mlRankMap);break;case"profilesetup":var mlRankMap=globalDataInteractionObj.userData.mlRankMap()||"mlapprentice";globalDataInteractionObj.userData.setUserMapHandler(function(mlRankMap){globalDataInteractionObj.userData.userMapHandler||("mlapprentice"==mlRankMap?globalDataInteractionObj.userData.userMapHandler=mlApprenticeConfig:"mlambassador"==mlRankMap?globalDataInteractionObj.userData.userMapHandler=mlAmbssadorConfig:"eu"==mlRankMap&&(globalDataInteractionObj.userData.userMapHandler=euConfig),globalDataInteractionObj.userData.setUserMapLanguage(mlRankMap),globalDataInteractionObj.mapInteractionHandler.mapInit(mlRankMap),globalDataInteractionObj.interactionHandler.subInit(mlRankMap),globalDataInteractionObj.mapInteractionHandler.wireMapButtons()),globalDataInteractionObj.userData.updateProfile()},mlRankMap)}$.ajax(globalDataInteractionObj.ajaxUtilities.ajaxSwitch(callParams.httpRequestType,callParams.dataPoints,callParams.dataSource,typeIn)).done(function(data){if(callParams.dataResponse=data,"coursedetaildata"==typeIn)globalDataInteractionObj.ajaxUtilities.fillCourseDetailModal(data,courseId);else if("coursedetaillink"==typeIn)globalDataInteractionObj.ajaxUtilities.runCourseDetailLinkAjaxSequence(data,courseId);else if("getquizquestions"==typeIn||"getquizanswers"==typeIn)globalDataInteractionObj.handlebarsUtils.setTemplates("quiz-modal",data),quiz.data=data,console.log(quiz.data),$("div.pre-load-modal").hide();else if("getcoursevideo"==typeIn){var videoModal=$("#video-modal"),video_url="",video_bitrate=0;data.DATA.MEDIA_INFO.encodings.forEach(function(encoding){"Mpegts"==encoding.container_type&&encoding.video_bitrate>video_bitrate&&(video_url=encoding.master_playlist_url,video_bitrate=encoding.video_bitrate)}),video_url=video_url.replace(/^http:\/\//i,"https://"),$("#video-modal div.inner").html('<i class="icon-close-btn"></i><video id="video-coach" width="960" height="540" preload="auto" class="video-js vjs-default-skin" controls><source src="" type="application/x-mpegURL" id="video-source"></source></video>'),$("#video-source").attr("src",video_url);var player=videojs("#video-coach",{autoplay:!1});$("div.pre-load-modal").fadeOut(300),TweenLite.to(videoModal,.35,{autoAlpha:1,ease:"Power3.easeIn"}),monthly_focus.child=!0,player.load(),globalDataInteractionObj.ajaxUtilities.ajaxLauncher("updatecreateuserrecord",questionId,parentId,"Complete"),$("#"+questionId).parents("li").next().children().children().removeClass("disabled"),player.on("ended",function(){TweenLite.to(videoModal,.35,{autoAlpha:0,ease:"Power3.easeOut"}),player.dispose(),monthly_focus.child=!1}),$(document).on("click touchstart","#video-modal",function(e){var clicked=$(e.target);if(clicked.is("#video-modal")||clicked.is(".icon-close-btn")){if($("#video-coach").is("div")){var player=videojs("#video-coach");player&&player.dispose()}return monthly_focus.child=!1,TweenLite.to(videoModal,.35,{autoAlpha:0,ease:"Power3.easeOut"}),!1}})}else"userdata"==typeIn&&(globalDataInteractionObj.objectProperties.userObjectRecords=data.OBJECT_RECORDS)}).fail(function(jqxhr,status){callParams.dataResponse={data:"none"}}).always(function(){"function"==typeof callParams.sequenceRunner&&callParams.sequenceRunner(callParams.dataResponse,callParams.detailId)})},runUserAjaxSequence:function(){var userDataObj=globalDataInteractionObj.userData,userItineraryResponse=globalDataInteractionObj.objectProperties.rawAjaxItineraryData,userCourseResponse=globalDataInteractionObj.objectProperties.rawAjaxCourseData;if(userCourseResponse.DATA&&"undefined"!=userCourseResponse.DATA){var completionPercentage=globalDataInteractionObj.userData.calculateCourseCompletionPercentage(userCourseResponse.DATA.CUSTOM_ATTRIBUTES.COURSES_COMPLETED,userCourseResponse.DATA.CUSTOM_ATTRIBUTES.TOTAL_COURSES),completionAverage=globalDataInteractionObj.userData.calculateCourseCompletionAverage(userCourseResponse.DATA.CUSTOM_ATTRIBUTES.COURSES_COMPLETED,userCourseResponse.DATA.CUSTOM_ATTRIBUTES.TOTAL_SCORES),completionAssessmentPercentage=(globalDataInteractionObj.userData.displayAssessmentAverage(userCourseResponse.DATA.CUSTOM_ATTRIBUTES.ASSESSMENT_AVE_PERCENTAGE),globalDataInteractionObj.userData.calculateAssessmentCompletion(userCourseResponse.DATA.CUSTOM_ATTRIBUTES.TOTAL_ASSESSMENTS,userCourseResponse.DATA.CUSTOM_ATTRIBUTES.ASSESSMENTS_COMPLETED));userDataObj.displayNameAndTitle(userCourseResponse.DATA.FIRST_NAME,userCourseResponse.DATA.LAST_NAME,userCourseResponse.DATA.CUSTOM_ATTRIBUTES.ML_RANK,userCourseResponse.DATA.CUSTOM_ATTRIBUTES.ML_RANK_SINCE),userDataObj.displayCityStateCountry(userCourseResponse.DATA.LocationCity,userCourseResponse.DATA.LocationState,userCourseResponse.DATA.LocationCountry),userDataObj.displayAssociateRole(userCourseResponse.DATA.Role),userDataObj.fetchMonthlyFocusScores(userItineraryResponse),userDataObj.displayJoinCoach(userCourseResponse.DATA["Last Hire Date"]),userDataObj.displayAssociateDate(userCourseResponse.DATA.DateInJob),userDataObj.displayAssociateAvatar(userCourseResponse.DATA.USER_AVATAR)||"images/profile-empty-avatar.png",userDataObj.displaySliderAvatar(userCourseResponse.DATA.USER_AVATAR),userDataObj.displayCourseCompletionPercentage(completionPercentage),userDataObj.calculateAndDisplayRadialProgressBar(completionPercentage,"progress-monthly-completion-circle"),userDataObj.displayCourseCompletionAverage(completionAverage,userCourseResponse.DATA.CUSTOM_ATTRIBUTES.COURSES_COMPLETED,userCourseResponse.DATA.CUSTOM_ATTRIBUTES.TOTAL_SCORES),userDataObj.displayMeterCompletions(userCourseResponse.DATA.CUSTOM_ATTRIBUTES.COURSES_COMPLETED),userDataObj.displayAssessmentCompletions(completionAssessmentPercentage),userDataObj.calculateAndDisplayRadialProgressBar(completionAverage,"progress-monthly-average-circle"),userDataObj.calculateAndDisplayRadialProgressBar(completionPercentage,"progress-profile-monthly-completion-circle"),userDataObj.calculateAndDisplayRadialProgressBar(completionAssessmentPercentage,"progress-assessment-completion-circle"),userDataObj.calculateAndDisplayRadialProgressBar(completionAssessmentPercentage,"progress-profile-assessment-completion-circle"),userDataObj.calculateAndDisplayRadialProgressBar(userCourseResponse.DATA.CUSTOM_ATTRIBUTES.ASSESSMENT_AVE_PERCENTAGE,"progress-assessment-average-circle")}},runCourseAjaxSequence:function(){var userCourseDataResponse={" Row 1":globalDataInteractionObj.objectProperties.rawAjaxCourseData[" Row 1"]," Row 2":globalDataInteractionObj.objectProperties.rawAjaxCourseData[" Row 2"]," Row 3":globalDataInteractionObj.objectProperties.rawAjaxCourseData[" Row 3"]," Row 4":globalDataInteractionObj.objectProperties.rawAjaxCourseData[" Row 4"]};globalDataInteractionObj.handlebarsUtils.setTemplates("course-data-summary-template",userCourseDataResponse),globalDataInteractionObj.courseData.carouselSequence(),globalDataInteractionObj.courseDetail.eventInit()},runCourseDetailAjaxSequence:function(courseElem){var courseDetailData=globalDataInteractionObj.objectProperties.rawAjaxCourseDetailData,mappedData=globalDataInteractionObj.courseDetail.getDetailContentById(courseDetailData.courseDetail,courseElem);globalDataInteractionObj.handlebarsUtils.setTemplates("course-detail-overlay",mappedData),globalDataInteractionObj.courseDetail.getMatchingCourseAttributes(courseElem),globalDataInteractionObj.courseDetail.setUpOverlay(".course-detail"),$(".close-overlay").on("click touchstart",function(){globalDataInteractionObj.courseDetail.prepOverlayTeardown(".course-detail")})},updateObjectRecord:function(recordId,status,currentLink){globalDataInteractionObj.ajaxUtilities.ajaxLauncher("updateuserobjectrecord",recordId,status),$("#"+currentLink).parents("li").next().children().children().removeClass("disabled")},removeDisableClassForNextChild:function(elementId,parentId){$("#"+elementId).parents("li").find("img").attr("src","/images/checkboxes/check-mark-green.png"),$("#"+elementId).parents("li").next().length>0&&!$("#"+elementId).hasClass("off-canvas-video")?($("#"+elementId).parents("li").next().children().children().removeClass("disabled"),globalDataInteractionObj.objectProperties.rawAjaxCourseData[monthly_focus.location[0]][monthly_focus.location[1]].children[parseInt($("#"+elementId).attr("attr-location"))+1].disabled=""):($("#"+parentId).addClass("open"),$("#"+parentId).parent("div").prev().prev().prev().children("img").addClass("open"));loop1:for(var row_key in globalDataInteractionObj.objectProperties.rawAjaxCourseData)for(var object_key in globalDataInteractionObj.objectProperties.rawAjaxCourseData[row_key])for(var child_key in globalDataInteractionObj.objectProperties.rawAjaxCourseData[row_key][object_key].children)if(globalDataInteractionObj.objectProperties.rawAjaxCourseData[row_key][object_key].children[child_key].object_id==elementId){globalDataInteractionObj.objectProperties.rawAjaxCourseData[row_key][object_key].children[child_key].is_objective_complete=!0;break loop1}},runCourseDetailLinkAjaxSequence:function(data){},fillCourseDetailModal:function(data,courseElem){data.courseSummary=$(".course-description-"+courseElem).text(),globalDataInteractionObj.handlebarsUtils.setTemplates("course-detail-overlay",data),$("div.pre-load-modal").hide(),globalDataInteractionObj.courseDetail.getMatchingCourseAttributes(courseElem),globalDataInteractionObj.courseDetail.setUpOverlay(".course-detail"),monthly_focus.child_has_been_opened||($(".course-detail").on("click touchstart",function(e){var clicked=$(e.target);!clicked.is(".icon-close-btn")&&!clicked.is(".course-detail")||monthly_focus.child||globalDataInteractionObj.courseDetail.prepOverlayTeardown(".course-detail")}),monthly_focus.child_has_been_opened=!0),window.onscroll=function(){monthly_focus.class_link&&(monthly_focus.child||globalDataInteractionObj.courseDetail.prepOverlayTeardown(".course-detail"))}},fillQuizQuestions:function(objectId,parentId){globalDataInteractionObj.ajaxUtilities.ajaxLauncher("getquizquestions",objectId,parentId)},addAjaxPathIndex:function(templateName){var fullPath;return fullPath=globalDataInteractionObj.objectProperties.forcePath?site_url+"/index.php/"+templateName:site_url+templateName}},handlebarsUtils:{setHandlebarsHelpers:function(){Handlebars.registerHelper("greaterThanThree",function(lengthIn,options){return lengthIn>3?options.fn(this):void 0}),Handlebars.registerHelper("isOpen",function(param,options){return"false"==param?options.fn(this):void 0}),Handlebars.registerHelper("isComplete",function(param,options){return"true"==param?options.fn(this):void 0}),Handlebars.registerHelper("isLink",function(param,options){return"link"==param||"true"==param?options.fn(this):options.inverse(this)}),Handlebars.registerHelper("isInstagram",function(param,options){return"instagram"==param||"true"==param?options.fn(this):options.inverse(this)}),Handlebars.registerHelper("stringTitle",function(passedString){var theString=passedString.replace(/\(/g,"<br/> (");return new Handlebars.SafeString(theString)})},setTemplates:function(elemIdIn,jsonResponse){this.setHandlebarsHelpers();var jQselector="#"+elemIdIn,classMap=globalDataInteractionObj.objectProperties.handlebarsDomMap;for(var prop in classMap){var jqTemplateElem="#"+prop,jqViewElem="."+classMap[prop];if(jQselector==jqTemplateElem){var sourceScript=$(jqTemplateElem).html(),template=Handlebars.compile(sourceScript),compiledTemplate=template(jsonResponse);$(jqViewElem).html(compiledTemplate)}}}},userData:{type:"userdata",userLearningObjects:{},userMapHandler:null,isRetailOrOutlet:function(){var pathToUserCourseFile;switch(globalDataInteractionObj.objectProperties.apiUserId){case"4":pathToUserCourseFile="outlet";break;default:pathToUserCourseFile="retail"}return pathToUserCourseFile},checkCookie:function(){$(document).on("click touchstart",function(e){var currentUserId=globalDataInteractionObj.utilities.getCookie("exp_elan_user_id");globalDataInteractionObj.utilities.getCookie("exp_elan_username");if(""==currentUserId){var logoutPath=$("a.logout-link").attr("href");location.href=logoutPath}})},getJourneyVideo:function(){var languageID=globalDataInteractionObj.objectProperties.apiUserLanguage.id;switch(languageID){case 1:$(".off-canvas-video").attr("id","143");break;case 6:$(".off-canvas-video").attr("id","1626");break;case 11:$(".off-canvas-video").attr("id","1627");break;case 12:$(".off-canvas-video").attr("id","1628");break;case 13:$(".off-canvas-video").attr("id","1629")}},displayNameAndTitle:function(firstNameIn,lastNameIn,levelIn,rankSinceIn){$(".assoc-name").text(firstNameIn+" "+lastNameIn),$(".assoc-rank-date").text(rankSinceIn),"ML APPRENTICE"!=levelIn?($(".assoc-rank").text(globalDataInteractionObj.utilities.lang("mltrainee")),$(".assoc-rank-footer").text(globalDataInteractionObj.utilities.lang("mltraineefooter")),$(".assoc-rank-next").text(globalDataInteractionObj.utilities.lang("mlapprentice"))):$(".assoc-rank").text(levelIn)},displayCityStateCountry:function(cityIn,stateIn,countryIn){var theComma=", ";null==cityIn&&(cityIn="",theComma=""),null==stateIn&&(stateIn="",theComma=""),null==countryIn&&(countryIn=""),$(".assoc-city").text(cityIn+""+theComma+stateIn),$(".assoc-country").text(countryIn)},displayJoinCoach:function(joinDateIn){$(".joined-coach-date").text(joinDateIn)},displayAssociateRole:function(associateRoleIn){$(".associate-role").text(associateRoleIn)},displayAssociateDate:function(associateDateIn){$(".associate-date").text(associateDateIn)},displayAssociateAvatar:function(associateAvatarIn){""!=associateAvatarIn&&$(".profile-main-image-avatar").css({"background-image":"url("+associateAvatarIn+")"})},displaySliderAvatar:function(associateAvatarIn){""!=associateAvatarIn&&$(".nav-avatar").css({"background-image":"url("+associateAvatarIn+")"})},displayNextDestination:function(){var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),currentNeighborhood=globalDataInteractionObj.mapInteractionHandler.currentNeighborhood;if(currentNeighborhood){var neighborhoodInfo=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"cat_name",currentNeighborhood,"NEIGHBORHOOD");$(".next-destination").text(globalDataInteractionObj.utilities.lang(neighborhoodInfo.cat_url_title)),$(".myprofile-row-3-2").html('<img id="destination-image" src="'+globalDataInteractionObj.objectProperties.appRoot+"images/destinations/"+globalDataInteractionObj.objectProperties.apiUserLanguage.abbreviation+"/"+neighborhoodInfo.cat_url_title+'.jpg" />')}},displayTargetArrival:function(){var monthNames=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],msec=Date.parse("May 1, 2017"),centerTargetDate=new Date(msec);centerTargetDate=new Date(centerTargetDate.setMonth(centerTargetDate.getMonth()));var leftTargetDate=new Date(centerTargetDate.setMonth(centerTargetDate.getMonth()-1)),rightTargetDate=new Date(centerTargetDate.setMonth(centerTargetDate.getMonth()+2)),centerTargetYear=centerTargetDate.getUTCFullYear(),centerTargetMonth=monthNames[centerTargetDate.getUTCMonth()-1],leftTargetYear=(centerTargetDate.getUTCDate(),leftTargetDate.getUTCFullYear()),rightTargetYear=rightTargetDate.getUTCFullYear(),leftTargetMonth=monthNames[leftTargetDate.getUTCMonth()],rightTargetMonth=monthNames[rightTargetDate.getUTCMonth()];$(".left-target-arrival").text(globalDataInteractionObj.utilities.lang(leftTargetMonth).substring(2,12)+" "+leftTargetYear),$(".center-target-arrival").text(globalDataInteractionObj.utilities.lang(centerTargetMonth)+" "+centerTargetYear),$(".right-target-arrival").text(globalDataInteractionObj.utilities.lang(rightTargetMonth).substring(0,8)+" "+rightTargetYear)},calculateCourseCompletionPercentage:function(completedCourses,totalCourses){var intOut=Math.round(100*(completedCourses/totalCourses).toFixed(2));return intOut},displayCourseCompletionPercentage:function(intIn){if(isNaN(intIn))var percentageString="0&#37;";else var percentageString=intIn+"&#37;";$(".data-course-completion").html(percentageString),intIn>=85?($(".data-course-completion-color").attr("stroke","rgba(100,196,151,1.0)"),$(".progress-profile-monthly-completion-circle").attr("stroke","rgba(100,196,151,1.0)"),$(".progress-monthly-completion-circle").attr("stroke","rgba(100,196,151,1.0)")):($(".data-course-completion-color").attr("stroke","rgba(247,79,61,1.0)"),$(".progress-profile-monthly-completion-circle").attr("stroke","rgba(247,79,61,1.0)"),$(".progress-monthly-completion-circle").attr("stroke","rgba(247,79,61,1.0)"))},calculateCourseCompletionAverage:function(completedCourses,totalScores){var intOut=Math.round(totalScores/completedCourses);return intOut},fetchMonthlyFocusScores:function(dataIn){var monthlyFocusBody=$("div#accordion div#monthlyfocus div.panel-body");$(monthlyFocusBody).empty(),dataIn.hasOwnProperty("DATA")&&$.each(dataIn.DATA,function(mindex,mvalue){if(0!=mvalue.TOTAL_ASSESSMENTS){var completion=Math.round(100*(mvalue.ASSESSMENTS_COMPLETED/mvalue.TOTAL_ASSESSMENTS).toFixed(2)),monthlyfocus='<div class="col-md-12 panel-row">';monthlyfocus+='<div class="col-md-1"></div>',monthlyfocus+='<div class="col-md-4 monthlyfocus-itinerary-course-title vertical-align"><h3>'+globalDataInteractionObj.utilities.lang(mindex)+"</h3></div>",monthlyfocus+='<div class="col-md-2 monthly-focus-scores">',monthlyfocus+=completion>=85?'<div class="monthly-panel-circle monthly-focus-comp-score" style="background-color:rgb(100,196,151);">':'<div class="monthly-panel-circle monthly-focus-comp-score" style="background-color:rgb(247,79,61);">',monthlyfocus+="<h4>"+completion+"&#37;</h4>",monthlyfocus+="</div>",monthlyfocus+='<h5 class="monthly-score-text">'+globalDataInteractionObj.utilities.lang("completion")+"</h5>",monthlyfocus+="</div>",monthlyfocus+='<div class="col-md-2 monthly-focus-scores">',monthlyfocus+=mvalue.ASSESSMENT_AVG_PERCENTAGE>=85?'<div class="monthly-panel-circle monthly-focus-avg-score" style="background-color:rgb(100,196,151);">':'<div class="monthly-panel-circle monthly-focus-avg-score" style="background-color:rgb(247,79,61);">',monthlyfocus+="<h4>"+mvalue.ASSESSMENT_AVG_PERCENTAGE+"&#37;</h4>",monthlyfocus+="</div>",monthlyfocus+='<h5 class="monthly-score-text">'+globalDataInteractionObj.utilities.lang("score")+"</h5>",monthlyfocus+="</div>",monthlyfocus+="</div>",$(monthlyFocusBody).append(monthlyfocus)}})},displayCourseCompletionAverage:function(intIn,courseCompletedIn,totalScoresIn){if(isNaN(intIn))var scoreString="0&#37;";else var scoreString=intIn+"&#37;";var numberScores=totalScoresIn/courseCompletedIn,totalPercent=100-numberScores;$(".data-course-average-score").html(scoreString),$(".data-course-completed").css({width:numberScores+"%"}),$(".data-course-scores").css({width:totalPercent+"%"}),intIn>=85?($(".data-course-average-color").attr("stroke","rgba(100,196,151,1.0)"),$(".progress-monthly-average-circle").attr("stroke","rgba(100,196,151,1.0)")):($(".data-course-average-color").attr("stroke","rgba(247,79,61,1.0)"),$(".progress-monthly-average-circle").attr("stroke","rgba(247,79,61,1.0)"))},calculateAssessmentCompletion:function(totalAssessmentIn,assessmentsPassedIn){var intOut=Math.round(100*(assessmentsPassedIn/totalAssessmentIn).toFixed(2));return intOut},displayAssessmentCompletions:function(intOut){isNaN(intOut)?$(".data-assessments-complete").html("0&#37;"):$(".data-assessments-complete").html(intOut+"&#37;"),intOut>=85?($(".data-assessment-completion-color").attr("stroke","rgba(100,196,151,1.0)"),$(".data-assessment-completion-color").attr("fill","rgba(100,196,151,1.0)"),$(".progress-assessment-completion-circle").attr("stroke","rgba(100,196,151,1.0)"),$(".progress-profile-assessment-completion-circle").attr("stroke","rgba(100,196,151,1.0)")):($(".data-assessment-completion-color").attr("stroke","rgba(247,79,61,1.0)"),$(".data-assessment-completion-color").attr("fill","rgba(247,79,61,1.0)"),$(".progress-assessment-completion-circle").attr("stroke","rgba(100,196,151,1.0)"),$(".progress-profile-assessment-completion-circle").attr("stroke","rgba(247,79,61,1.0)"))},displayAssessmentAverage:function(assessmentPercentage){$(".data-assessments-percent").html(assessmentPercentage+"&#37;"),
assessmentPercentage>=85?($(".data-assessment-average-color").attr("stroke","rgba(100,196,151,1.0)"),$(".data-monthly-average-color").attr("fill","rgba(100,196,151,1.0)"),$(".progress-assessment-average-circle").attr("stroke","rgba(100,196,151,1.0)")):($(".data-assessment-average-color").attr("stroke","rgba(247,79,61,1.0)"),$(".data-monthly-average-color").attr("fill","rgba(247,79,61,1.0)"),$(".progress-assessment-average-circle").attr("stroke","rgba(247,79,61,1.0)"))},displayMeterCompletions:function(courseCompletedIn){var completedCourses=courseCompletedIn,gauge=$("#g2.gauge");"undefined"!=gauge&&completedCourses&&(gauge.attr("data-value",parseInt(completedCourses)),g2.refresh(courseCompletedIn))},calculateAndDisplayRadialProgressBar:function(intIn,elemIn){var jqSelector="."+elemIn,circleObjInstance=globalDataInteractionObj.utilities.setProgressionCircleParameters($(jqSelector));$(jqSelector).attr("stroke-dasharray",circleObjInstance.elemCircumference);var radialProgressInt=Math.round(intIn*circleObjInstance.elemRatio);setTimeout(function(){$(jqSelector).addClass("animation-trigger"),$(jqSelector).attr("stroke-dashoffset",radialProgressInt)},1e3)},displayPassportStamps:function(){var areaObjectId="",areaObjectStatus="",numberOfStamps=0,currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),areas=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_id","0");areas=globalDataInteractionObj.utilities.sortByProperty(areas,"unlockorder"),$.each(areas,function(akey,avalue){var areaObject=globalDataInteractionObj.utilities.findMapArea(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,avalue.cat_name);areaObjectStatus="","object"==typeof areaObject&&null!=areaObject&&(areaObjectId=areaObject.OBJECT_ID,areaObjectStatus=globalDataInteractionObj.userData.getUserObjectRecordStatus(areaObjectId),"Complete"==areaObjectStatus&&numberOfStamps++)}),$(".stamps-amount").text(numberOfStamps)},displayJourneyAccordion:function(){var accordionBody=$("div#accordion div#mlapprentice div#accordion2");$(accordionBody).empty();var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),areas=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_id","0");areas=globalDataInteractionObj.utilities.sortByProperty(areas,"unlockorder");var panelNumber=0;$.each(areas,function(akey,avalue){var areaObject=globalDataInteractionObj.utilities.findMapArea(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,avalue.cat_name);if(console.log("----------each areas",avalue.cat_name),"object"==typeof areaObject&&null!=areaObject){panelNumber+=1;var currentAreaStatus=globalDataInteractionObj.userData.getUserObjectRecordStatus(areaObject.OBJECT_ID),neighborhoods=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_id",avalue.cat_id);if(neighborhoods=globalDataInteractionObj.utilities.sortByProperty(neighborhoods,"unlockorder"),neighborhoods&&neighborhoods.length>0){var currentAreaScore=0,neighborhoodRow="";neighborhoodRow+='<div class="panel area-row panel-default panel-'+panelNumber+' col-lg-12 col-md-12">',neighborhoodRow+='<button class="btn-toggle-sub" type="button" data-toggle="collapse" data-target="#target'+panelNumber+'" data-parent="#accordion2"><span class="is-open-sub glyphicon glyphicon-plus plusMinus"></span>',neighborhoodRow+='<div class="col-md-5 area-panel vertical-center"><h3 class="area-title">'+globalDataInteractionObj.utilities.toProperCase(globalDataInteractionObj.utilities.truncateString(areaObject.OBJECT_NAME))+'</h3><h3 class="area-name">'+globalDataInteractionObj.utilities.lang(avalue.cat_url_title)+"</h3></div>","Complete"==currentAreaStatus?(neighborhoodRow+='<div class="col-md-3 area-score vertical-center">',neighborhoodRow+='<div class="area-avg-score-'+areaObject.OBJECT_ID+' panel-circle">',neighborhoodRow+='<span class="current-area-score-'+areaObject.OBJECT_ID+'"></span>',neighborhoodRow+="</div>",neighborhoodRow+='<h5 class="score-text-area">'+globalDataInteractionObj.utilities.lang("score")+"</h5>",neighborhoodRow+="</div>",neighborhoodRow+='<div class="col-md-2 itinerary-links area-links-complete vertical-center"><a class="callToAction" data-objectid="'+areaObject.OBJECT_ID+'" href="javascript://">'+globalDataInteractionObj.utilities.lang("review")+"</a></div>"):"Started"==currentAreaStatus&&(neighborhoodRow+='<div class="col-md-3 area-score-progress vertical-center">'+globalDataInteractionObj.utilities.lang("inprogress")+"</div>",neighborhoodRow+='<div class="col-md-2 itinerary-links area-links-inprogress vertical-center"><a class="callToAction" data-objectid="'+areaObject.OBJECT_ID+'" href="javascript://">'+globalDataInteractionObj.utilities.lang("continue")+"</a></div>"),neighborhoodRow+='</button><div id="target'+panelNumber+'" class="panel-collapse collapse">',neighborhoodRow+='<div class="panel-body">',$.each(neighborhoods,function(nkey,nvalue){var neighborhoodObject=globalDataInteractionObj.utilities.findMapNeighborhood(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,nvalue.cat_name);if("object"==typeof neighborhoodObject&&null!=neighborhoodObject){var currentNeighborhoodStatus=globalDataInteractionObj.userData.getUserObjectRecordStatus(neighborhoodObject.OBJECT_ID),currentNeighborhoodScore=globalDataInteractionObj.userData.getUserObjectRecordScore(neighborhoodObject.OBJECT_ID);neighborhoodRow+="Started"==currentNeighborhoodStatus?'<div class="panel-body"><div class="col-lg-12 col-md-12 panel-row in-progress">':'<div class="panel-body"><div class="col-lg-12 col-md-12 panel-row">',neighborhoodRow+='<span class="itinerary-completed-check">',neighborhoodRow+="Complete"==currentNeighborhoodStatus?'<img src="'+globalDataInteractionObj.objectProperties.appRoot+'images/checkboxes/check-mark-green.png" class="image-checkbox-itinerary"/>':'<img src="'+globalDataInteractionObj.objectProperties.appRoot+'images/checkboxes/nocheck-mark.png" class="image-checkbox-itinerary"/>',neighborhoodRow+="</span>",neighborhoodRow+=currentNeighborhoodScore>=85?'<div class="col-md-5 itinerary-course-title" style="color: #64C497 !important"><h3>'+neighborhoodObject.OBJECT_NAME+'</h3><h3 class="neighborhood-name">'+globalDataInteractionObj.utilities.lang(nvalue.cat_url_title)+"</h3></div>":'<div class="col-md-5 itinerary-course-title"><h3>'+neighborhoodObject.OBJECT_NAME+'</h3><h3 class="neighborhood-name">'+globalDataInteractionObj.utilities.lang(nvalue.cat_url_title)+"</h3></div>","Complete"==currentNeighborhoodStatus?(neighborhoodRow+='<div class="col-md-3 itinerary-score">',neighborhoodRow+=currentNeighborhoodScore>=85?'<div class="panel-circle itinerary-score" style="background-color:rgb(100,196,151);">':'<div class="panel-circle itinerary-score" style="background-color:rgb(247,79,61);">',neighborhoodRow+='<span class="single-data-course-average-score">'+currentNeighborhoodScore+"%</span>",neighborhoodRow+="</div>",neighborhoodRow+='<h5 class="score-text">'+globalDataInteractionObj.utilities.lang("score")+"</h5>",neighborhoodRow+="</div>",neighborhoodRow+='<div class="col-md-2 itinerary-links"><a class="callToAction" data-objectid="'+neighborhoodObject.OBJECT_ID+'" href="javascript://">'+globalDataInteractionObj.utilities.lang("review")+"</a></div>",currentAreaScore=currentNeighborhoodScore+currentAreaScore):"Started"==currentNeighborhoodStatus?(neighborhoodRow+='<div class="col-md-3 itinerary-score">'+globalDataInteractionObj.utilities.lang("inprogress"),neighborhoodRow+="</div>",neighborhoodRow+='<div class="col-md-2 itinerary-links"><a class="callToAction" data-objectid="'+neighborhoodObject.OBJECT_ID+'" href="javascript://">'+globalDataInteractionObj.utilities.lang("continue")+"</a></div>"):(neighborhoodRow+='<div class="col-md-3 itinerary-score">',neighborhoodRow+="</div>",neighborhoodRow+='<div class="col-md-2 itinerary-links"></div>'),neighborhoodRow+="</div></div>"}}),$(accordionBody).append(neighborhoodRow)}neighborhoodRow+="</div>";var numberOfNeighborhoods=neighborhoods&&neighborhoods.length>0?neighborhoods.length:1,thisAreaScore=Math.round(Number(currentAreaScore)/numberOfNeighborhoods).toFixed(),areaClass="current-area-score-"+areaObject.OBJECT_ID,areaAvg="area-avg-score-"+areaObject.OBJECT_ID;thisAreaScore>84?($("."+areaAvg).css("background-color","rgb(100,196,151)"),$("."+areaClass).html(thisAreaScore+"&#37;"),$(".area-title").css({color:"rgb(100,196,151)"}),$(".area-name").css({color:"rgb(100,196,151)"})):(console.log(thisAreaScore+"Under 85"),$("."+areaAvg).css("background-color","rgb(247,79,61)"),$("."+areaClass).html(thisAreaScore+"&#37;"))}}),$(accordionBody).find("a.callToAction").click(function(){var learningObjectId=$(this).attr("data-objectid");globalDataInteractionObj.utilities.launchNeighborhoodCourse(learningObjectId)})},myProfileTabEventHandler:function(){$(".btn-toggle").on("click",function(){$(".is-open").removeClass("glyphicon-minus").addClass("glyphicon-plus");var isExpanded=$(this).attr("data-target"),textViewable=$(isExpanded).hasClass("in"),toggleElem=$(this).find(".is-open");toggleElem.removeClass("glyphicon-plus, glyphicon-minus"),textViewable?toggleElem.addClass("glyphicon-plus"):toggleElem.addClass("glyphicon-minus")}),$(".btn-toggle-sub").on("click",function(){$(".is-open-sub").removeClass("glyphicon-minus").addClass("glyphicon-plus");var isExpanded=$(this).attr("data-target"),textViewable=$(isExpanded).hasClass("in"),toggleElem=$(this).find(".is-open-sub");toggleElem.removeClass("glyphicon-plus, glyphicon-minus"),textViewable?toggleElem.addClass("glyphicon-plus"):toggleElem.addClass("glyphicon-minus")})},fetchUserObjectRecords:function(callback){var parameters={type:"userobjectrecords"},infiniteLoop=0;$.ajax(globalDataInteractionObj.ajaxUtilities.ajaxSwitch("GET",parameters,"api")).done(function(response){response.hasOwnProperty("DATA")&&(globalDataInteractionObj.userData.userLearningObjects=response.DATA,"function"==typeof callback&&callback()),infiniteLoop+=1})},fetchUserObjectRecord:function(currentObjectId,callback){var parameters={type:"userobjectrecords",object_id:currentObjectId},userObjectRecord=!1;$.ajax(globalDataInteractionObj.ajaxUtilities.ajaxSwitch("GET",parameters,"api")).done(function(response,textStatus,jqHXR){response.hasOwnProperty("STATUS")&&(1==response.STATUS?(response.hasOwnProperty("DATA")&&(userObjectRecord=response.DATA[0]),"function"==typeof callback&&callback(userObjectRecord)):$("a#mapCallToAction").css("pointer-events","auto"))})},createUserObjectRecord:function(currentObject,callback){var parameters={};parameters={type:"createuserobjectrecord",object_id:currentObject.OBJECT_ID,status:"Started",parent_object_id:currentObject.OBJECT_PARENT_IDS};var userObjectRecord=!1;$.ajax(globalDataInteractionObj.ajaxUtilities.ajaxSwitch("GET",parameters,"api")).done(function(response){response.hasOwnProperty("DATA")&&(userObjectRecord=response.DATA),"function"==typeof callback&&callback(userObjectRecord)})},updateUserObjectRecord:function(recordId,status,callback){var parameters={};parameters={type:"updateuserobjectrecord",record_id:recordId,status:status};var userObjectRecord=!1;$.ajax(globalDataInteractionObj.ajaxUtilities.ajaxSwitch("GET",parameters,"api")).done(function(response){response.hasOwnProperty("DATA")&&(userObjectRecord=response.DATA),"function"==typeof callback&&callback(userObjectRecord)})},updateUserObjectRecordStatusByObjectId:function(objectId,status,callback){if("undefined"!=typeof objectId&&null!=objectId){var objectRecord=globalDataInteractionObj.utilities.findOneByProperty(globalDataInteractionObj.userData.userLearningObjects,"OBJECT_ID",objectId);"object"==typeof objectRecord&&null!=objectRecord&&objectRecord.hasOwnProperty("RECORD_ID")&&globalDataInteractionObj.userData.updateUserObjectRecord(objectRecord.RECORD_ID,status,callback)}},getUserObjectRecordStatus:function(objectId){var userObjectRecordStatus="locked";if("undefined"!=typeof objectId&&null!=objectId){var objectRecord=globalDataInteractionObj.utilities.findOneByProperty(globalDataInteractionObj.userData.userLearningObjects,"OBJECT_ID",objectId);"object"==typeof objectRecord&&null!=objectRecord&&objectRecord.hasOwnProperty("STATUS")&&(userObjectRecordStatus=objectRecord.STATUS)}return userObjectRecordStatus},getUserObjectRecordScore:function(objectId){var userObjectRecordScore="";if("undefined"!=typeof objectId&&null!=objectId){var objectRecord=globalDataInteractionObj.utilities.findOneByProperty(globalDataInteractionObj.userData.userLearningObjects,"OBJECT_ID",objectId);"object"==typeof objectRecord&&null!=objectRecord&&objectRecord.hasOwnProperty("SCORE")&&(userObjectRecordScore=objectRecord.SCORE)}return userObjectRecordScore},setUserLanguage:function(){var userDataResponse=globalDataInteractionObj.objectProperties.rawAjaxUserData;if(userDataResponse.hasOwnProperty("DATA")){var languageObject=globalDataInteractionObj.utilities.findOneByProperty(elanLanguages,"id",userDataResponse.DATA.LANGUAGE_ID);"undefined"!=typeof languageObject&&null!=languageObject&&(globalDataInteractionObj.objectProperties.apiUserLanguage=languageObject)}},setLanguageCommonTerms:function(){var userDataResponse=globalDataInteractionObj.objectProperties.rawAjaxUserData;if(userDataResponse.hasOwnProperty("DATA")&&userDataResponse.DATA.hasOwnProperty("CUSTOM_ATTRIBUTES")&&userDataResponse.DATA.CUSTOM_ATTRIBUTES.hasOwnProperty("CURRENT_MONTH_TAG")){var d=new Date,current_month_tag=(d.getMonth(),userDataResponse.DATA.CUSTOM_ATTRIBUTES.CURRENT_MONTH_TAG);current_month_tag=current_month_tag.toLowerCase();var landing_page_heading=globalDataInteractionObj.utilities.lang("whats_"+current_month_tag);$("div.landing-page-heading h1").text(landing_page_heading);var current_month=globalDataInteractionObj.utilities.lang(current_month_tag).toLowerCase();$("div.associate-completion span.current-month").text(current_month)}},setUserMapLanguage:function(mlRankMap){var abbreviation=globalDataInteractionObj.objectProperties.apiUserLanguage.abbreviation,dt="?"+(new Date).getTime(),mapCssName=mlRankMap+".config.css",mapCssPath=globalDataInteractionObj.objectProperties.appRoot+"js/jqvmap/"+mapCssName+dt,mapCssRef=document.createElement("link");mapCssRef.setAttribute("rel","stylesheet"),mapCssRef.setAttribute("type","text/css"),mapCssRef.setAttribute("href",mapCssPath),document.getElementsByTagName("head")[0].appendChild(mapCssRef);var mapLangCssName=mlRankMap+"."+abbreviation+".css",mapLangCssPath=globalDataInteractionObj.objectProperties.appRoot+"js/jqvmap/i18n/"+mapLangCssName+dt,mapLangCssRef=document.createElement("link");mapLangCssRef.setAttribute("rel","stylesheet"),mapLangCssRef.setAttribute("type","text/css"),mapLangCssRef.setAttribute("href",mapLangCssPath),document.getElementsByTagName("head")[0].appendChild(mapLangCssRef);var mapLangFileName=mlRankMap+"."+abbreviation+".json",mapLangFilePath=globalDataInteractionObj.objectProperties.appRoot+"js/jqvmap/i18n/"+mapLangFileName+dt;$.getJSON(mapLangFilePath,function(data){globalDataInteractionObj.userData.userMapHandler.additionalContent=data.additionalContent})},setUserMapConfig:function(mlRankMap,callback){var mapConfigJsName=mlRankMap+".config.js",mapConfigJsPath=globalDataInteractionObj.objectProperties.appRoot+"js/jqvmap/"+mapConfigJsName,mapConfigJsRef=document.createElement("script");mapConfigJsRef.setAttribute("type","text/javascript"),mapConfigJsRef.setAttribute("charset","utf-8"),mapConfigJsRef.setAttribute("async","false"),mapConfigJsRef.setAttribute("src",mapConfigJsPath),mapConfigJsRef.onload=function(){"function"==typeof callback&&callback(mlRankMap)},document.getElementsByTagName("head")[0].appendChild(mapConfigJsRef)},mlRankMap:function(){var mlRankMap="mlapprentice",userDataResponse=globalDataInteractionObj.objectProperties.rawAjaxUserData;return userDataResponse.hasOwnProperty("DATA")&&userDataResponse.DATA.hasOwnProperty("CUSTOM_ATTRIBUTES")&&userDataResponse.DATA.CUSTOM_ATTRIBUTES.hasOwnProperty("ML_RANK_MAP")&&(mlRankMap=userDataResponse.DATA.CUSTOM_ATTRIBUTES.ML_RANK_MAP),mlRankMap},setUserMapHandler:function(callback,newMap){var mlRankMap=newMap||globalDataInteractionObj.userData.mlRankMap(),mapJsName="jquery.vmap."+mlRankMap+".js",mapJsPath=globalDataInteractionObj.objectProperties.appRoot+"js/jqvmap/"+mapJsName,mapJsRef=document.createElement("script");mapJsRef.setAttribute("type","text/javascript"),mapJsRef.setAttribute("charset","utf-8"),mapJsRef.setAttribute("async","false"),mapJsRef.setAttribute("src",mapJsPath),mapJsRef.onload=function(){globalDataInteractionObj.userData.setUserMapConfig(mlRankMap,callback)},document.getElementsByTagName("head")[0].appendChild(mapJsRef)},updateProfile:function(){globalDataInteractionObj.userData.displayTargetArrival(),globalDataInteractionObj.userData.displayNextDestination(),globalDataInteractionObj.userData.displayPassportStamps(),globalDataInteractionObj.userData.displayJourneyAccordion()},update:function(){globalDataInteractionObj.userData.fetchUserObjectRecords(function(){globalDataInteractionObj.mapInteractionHandler.currentArea=null,globalDataInteractionObj.mapInteractionHandler.currentNeighborhood=null;var nextNeighborhood=globalDataInteractionObj.mapInteractionHandler.getNeighborhoodObjectStatus(),currentArea=globalDataInteractionObj.mapInteractionHandler.currentArea;globalDataInteractionObj.mapInteractionHandler.displayAreaData(currentArea),globalDataInteractionObj.mapInteractionHandler.displayNeighborhoodData(nextNeighborhood);var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),neighborhoodInfo=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"cat_name",nextNeighborhood,"NEIGHBORHOOD");globalDataInteractionObj.mapInteractionHandler.doEventChanges("autoHash",neighborhoodInfo.parent_url_title,neighborhoodInfo.parent_name),globalDataInteractionObj.userData.updateProfile()})},userInit:function(){globalDataInteractionObj.userData.checkCookie(),globalDataInteractionObj.userData.fetchUserObjectRecords(),globalDataInteractionObj.ajaxUtilities.ajaxLauncher(this.type)},userUpdate:function(){globalDataInteractionObj.userData.fetchUserObjectRecords(),globalDataInteractionObj.ajaxUtilities.ajaxLauncher(this.type)}},courseData:{type:"usercoursedata",carouselSequence:function(){$(".carousel .item").each(function(){var next=$(this).next();next.length||(next=$(this).siblings(":first")),next.children(":first-child").clone().appendTo($(this)),next.next().length>0?next.next().children(":first-child").clone().appendTo($(this)):$(this).siblings(":first").children(":first-child").clone().appendTo($(this))})},courseInit:function(){document.getElementById("course-data-summary-template")&&globalDataInteractionObj.ajaxUtilities.ajaxLauncher(this.type)}},courseDetail:{type:"coursedetaildata",getMatchingCourseAttributes:function(elemIdIn){var jQselector="#"+elemIdIn,uiAttrElem=$(jQselector).parent().siblings(".attr-container"),selectedImg=uiAttrElem.children("img").attr("src"),courseTitleContainer=$(jQselector).parent().siblings(".course-title-container"),sectionHeadingContainer=$(jQselector).parent().siblings(".course-type-container"),sectionHeadingTitle=sectionHeadingContainer.children("h3").text(),courseTitle=courseTitleContainer.children("h4").text();courseTitle=courseTitle.replace(/\(/g,"<br/> ("),$(".course-heading").append("<h3>"+sectionHeadingTitle+"</h3>"),$("#imgWrapper").append("<img src="+selectedImg+" />"),$("#traversalData").append("<h4>"+courseTitle+"</h4>")},getDetailContentById:function(dataResponse,dataElem){var dataOut;for(var index in dataResponse){var selector=dataResponse[index].course_id;dataElem==selector&&(dataOut=dataResponse[index])}return dataOut},setUpOverlay:function(element){$(element).removeClass("fade-out-trigger").addClass("fade-in-trigger")},prepOverlayTeardown:function(element){$(element).addClass("fade-out-trigger").removeClass("fade-in-trigger"),setTimeout(function(){$(element).empty(),$(".class-link").removeClass("child-open"),$(".class-link").removeClass("active")},750),monthly_focus.class_link=!1,$("body").removeClass("modal-open")},eventInit:function(){$(".misc-link").on("click",function(){globalDataInteractionObj.ajaxUtilities.ajaxLauncher(globalDataInteractionObj.courseDetail.type,this.id)});var classFlag=!1;$(".class-link").on("click",function(){if($(this).addClass("active"),!$(this).hasClass("child-open")){if(""!=$(this).attr("attr-link")){window.open($(this).attr("attr-link"),"_blank");var object_id=$(this).attr("id");globalDataInteractionObj.ajaxUtilities.ajaxLauncher("updatecreateuserrecord",object_id,"","Complete"),$(this).addClass("open")}else{var data_location=($(this).attr("attr-children"),$(this).attr("attr-location").split("-")),parent_id=$(this).attr("id");$("div.pre-load-modal").fadeIn(300),monthly_focus.location=data_location,monthly_focus.class_link=!0,$(".class-link").addClass("child-open"),globalDataInteractionObj.ajaxUtilities.fillCourseDetailModal(globalDataInteractionObj.objectProperties.rawAjaxCourseData[data_location[0]][data_location[1]],parent_id)}classFlag=!0,setTimeout(function(){classFlag=!1},500)}return!1}),$(".misc-nolink").on("click",function(){window.open("https://www.instagram.com/coach/","_blank")})}},interactionHandler:{setHeightForObjectProperty:function(propertyIn,heightIn){propertyIn=heightIn},subInit:function(){$(window).on("resize",function(e){clearTimeout(resizer),globalDataInteractionObj.mapInteractionHandler.setContentHeight(),resizer=setTimeout(function(){globalDataInteractionObj.interactionHandler.setHeightForObjectProperty(globalDataInteractionObj.objectProperties.viewportHeight,document.documentElement.clientHeight),$(window).scrollTop(0),globalDataInteractionObj.mapInteractionHandler.setContentHeight()},250)})}},mapInteractionHandler:{mapLearningObjects:{},currentJQVMapObject:{},currentMapObject:{},currentMap:null,currentMapObjectId:null,currentArea:null,currentAreaObjectId:null,currentNeighborhood:null,currentNeighborhoodObjectId:null,loadSlideOutPanel:function(){var stopLoadPropagation=0;$("div.journey-content").load(globalDataInteractionObj.ajaxUtilities.addAjaxPathIndex("journey"),null,function(){console.log("LOAD~~~~~~~~~~~~~~~~~loadSlideOutPanel",stopLoadPropagation),0==stopLoadPropagation&&(globalDataInteractionObj.mapInteractionHandler.mapDataInit(),globalDataInteractionObj.mapInteractionHandler.setMapInfoHeight(),stopLoadPropagation+=1)})},setMapInfoHeight:function(){var windowHeight=$(window).height(),globalFooterHeight=$("footer#main-footer").height(),contentHeight=windowHeight-globalFooterHeight;$("div.journey-content").css("height",contentHeight),$("div.map-container").css("height",contentHeight),$("div#vmap").css("height",contentHeight),$("div.map-info-container").css("height",contentHeight),$("div.map-info").css("height",contentHeight),$("div#vmap svg").first().height(contentHeight)},setContentHeight:function(){var journeyContentWidth=(globalDataInteractionObj.objectProperties.isIPad,$("div#mapJourney").width());if(journeyContentWidth>0){var mapInfoWidth=$("div.journey-content div.map-info-container").width(),mapWidth=journeyContentWidth-mapInfoWidth;1800>=journeyContentWidth&&(mapWidth+=30),759>mapWidth&&(mapWidth=759),$("div#vmap svg").first().width(mapWidth)}globalDataInteractionObj.mapInteractionHandler.setMapInfoHeight()},getNeighborhoodObjectStatus:function(neighborhoodObjectId){var currentAreaId="",currentAreaStatus="",currentNeighborhoodId="",currentNeighborhoodStatus="",currentNeighborhoodTagName="",previousNeighborhoodStatus="",previousNeighborhoodTagName="";neighborhoodObjectId&&""!=neighborhoodObjectId||(neighborhoodObjectId=0);var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),elanMapUnlockObjectId=globalDataInteractionObj.mapInteractionHandler.getElanMapUnlockObjectId(),areas=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_id","0");areas=globalDataInteractionObj.utilities.sortByProperty(areas,"unlockorder");var neighborhoods=[];return areas.length>0&&$.each(areas,function(akey,avalue){var areaObject=globalDataInteractionObj.utilities.findMapArea(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,avalue.cat_name);return"object"==typeof areaObject&&null!=areaObject&&(currentAreaId=areaObject.OBJECT_ID),currentAreaStatus="locked",""!=currentAreaId&&(currentAreaStatus=globalDataInteractionObj.userData.getUserObjectRecordStatus(currentAreaId)),console.log("Area: "+currentAreaId+" - "+currentAreaStatus),neighborhoods=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_id",avalue.cat_id),neighborhoods=globalDataInteractionObj.utilities.sortByProperty(neighborhoods,"unlockorder"),neighborhoods.length>0&&$.each(neighborhoods,function(nkey,nvalue){var neighborhoodObject=globalDataInteractionObj.utilities.findMapNeighborhood(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,nvalue.cat_name);if("object"==typeof neighborhoodObject&&null!=neighborhoodObject&&(currentNeighborhoodId=neighborhoodObject.OBJECT_ID),currentNeighborhoodTagName=nvalue.cat_name,currentNeighborhoodStatus="locked",""!=currentNeighborhoodId&&(currentNeighborhoodStatus=globalDataInteractionObj.userData.getUserObjectRecordStatus(currentNeighborhoodId)),"locked"!=currentNeighborhoodStatus||"Complete"!=previousNeighborhoodStatus&&"Passed"!=previousNeighborhoodStatus||(currentNeighborhoodStatus="open"),currentNeighborhoodId==elanMapUnlockObjectId&&"locked"==currentNeighborhoodStatus&&(currentNeighborhoodStatus="open"),0==neighborhoodObjectId){var pinType="";if("open"==currentNeighborhoodStatus||"Started"==currentNeighborhoodStatus){"Started"==currentNeighborhoodStatus&&(pinType="progress");var currentArea=globalDataInteractionObj.mapInteractionHandler.currentArea;("undefined"==typeof currentArea||null==currentArea)&&(globalDataInteractionObj.mapInteractionHandler.currentArea=avalue.cat_name,globalDataInteractionObj.mapInteractionHandler.currentNeighborhood=nvalue.cat_name)}else("Complete"==currentNeighborhoodStatus||"Passed"==currentNeighborhoodStatus)&&(pinType="complete");if(""!=pinType){var pinImageName="pin-"+pinType+"-"+avalue.cat_url_title+".png",pingImagePath=globalDataInteractionObj.objectProperties.appRoot+"images/marker/"+pinImageName,pinContent="<div class='map-pin'><span class='pin-img' ";pinContent+="style=\"background-image: url('"+pingImagePath+"')\"",pinContent+=">",pinContent+="</span></div>",globalDataInteractionObj.mapInteractionHandler.setPin(nvalue.cat_url_title,pinContent)}}if("open"==currentNeighborhoodStatus&&""!=previousNeighborhoodTagName){var previousNeighborhoodAssessmentObject=globalDataInteractionObj.utilities.findMapNeighborhoodAssessment(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,previousNeighborhoodTagName);if("undefined"!=typeof previousNeighborhoodAssessmentObject&&null!=previousNeighborhoodAssessmentObject){var previousNeighborhoodAssessmentStatus=globalDataInteractionObj.userData.getUserObjectRecordStatus(previousNeighborhoodAssessmentObject.OBJECT_ID);"Complete"!=previousNeighborhoodAssessmentStatus&&(currentNeighborhoodStatus="locked")}}return previousNeighborhoodStatus=currentNeighborhoodStatus,previousNeighborhoodTagName=currentNeighborhoodTagName,currentNeighborhoodId==neighborhoodObjectId?!1:void 0}),currentNeighborhoodId==neighborhoodObjectId?!1:void(0==neighborhoodObjectId&&""!=currentAreaId&&"Started"==currentAreaStatus&&"Complete"==currentNeighborhoodStatus&&globalDataInteractionObj.userData.updateUserObjectRecordStatusByObjectId(currentAreaId,"Complete"))}),0==neighborhoodObjectId?(globalDataInteractionObj.mapInteractionHandler.displayPins(),globalDataInteractionObj.mapInteractionHandler.currentNeighborhood):currentNeighborhoodStatus},fetchMapLearningObjects:function(mapTagName){var parameters={};mapTagName||(mapTagName=globalDataInteractionObj.mapInteractionHandler.currentMap),mapTagName+=",English",parameters={type:"learninginfo",tags:mapTagName},$.ajax(globalDataInteractionObj.ajaxUtilities.ajaxSwitch("GET",parameters,"api")).done(function(response){response&&response.hasOwnProperty("DATA")&&(console.log("fetchMapLearningObjects",response.DATA),globalDataInteractionObj.mapInteractionHandler.mapLearningObjects=response.DATA,globalDataInteractionObj.mapInteractionHandler.setElanMapObjectId(),globalDataInteractionObj.mapInteractionHandler.setElanMapUnlockObjectId(),globalDataInteractionObj.mapInteractionHandler.preLoadLearningObjectImages(),globalDataInteractionObj.mapInteractionHandler.displayCurrentData())}).fail(function(jqxhr,status){})},preLoadLearningObjectImages:function(){var mapLearningObjects=globalDataInteractionObj.mapInteractionHandler.mapLearningObjects;$.each(mapLearningObjects,function(key,learningObject){$("<img/>")[0].src=learningObject.OBJECT_IMAGE})},setCurrentObject:function(currentLevel,currentObject){currentObject.OBJECT_LEVEL=currentLevel,currentObject.OBJECT_PARENT_IDS="","MAP"==currentLevel?(globalDataInteractionObj.mapInteractionHandler.currentMapObjectId=currentObject.OBJECT_ID,globalDataInteractionObj.mapInteractionHandler.currentAreaObjectId=null,globalDataInteractionObj.mapInteractionHandler.currentNeighborhoodObjectId=null):"AREA"==currentLevel?(globalDataInteractionObj.mapInteractionHandler.currentAreaObjectId=currentObject.OBJECT_ID,globalDataInteractionObj.mapInteractionHandler.currentNeighborhoodObjectId=null,currentObject.OBJECT_PARENT_IDS=globalDataInteractionObj.mapInteractionHandler.currentMapObjectId):"NEIGHBORHOOD"==currentLevel&&(globalDataInteractionObj.mapInteractionHandler.currentNeighborhoodObjectId=currentObject.OBJECT_ID,currentObject.OBJECT_PARENT_IDS=globalDataInteractionObj.mapInteractionHandler.currentMapObjectId,currentObject.OBJECT_PARENT_IDS=currentObject.OBJECT_PARENT_IDS+"|"+globalDataInteractionObj.mapInteractionHandler.currentAreaObjectId),globalDataInteractionObj.mapInteractionHandler.currentMapObject=currentObject},findMapObject:function(mapTagName){console.log("***findMapObject",mapTagName);var group_url_title="EU"==globalDataInteractionObj.mapInteractionHandler.currentMap?"mlambassador":"mlapprentice";if("undefined"==typeof mapTagName||null==mapTagName){mapTagName=globalDataInteractionObj.mapInteractionHandler.currentMap;var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo();console.log("***currentMapInfo",currentMapInfo);var mapInformation=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"group_name",mapTagName);group_url_title=mapInformation.group_url_title}var elanMapObjectId=globalDataInteractionObj.mapInteractionHandler.getElanMapObjectId(),mapObject=globalDataInteractionObj.utilities.findOneByProperty(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,"OBJECT_ID",elanMapObjectId);if("object"==typeof mapObject&&null!=mapObject){mapObject.OBJECT_TAG=mapTagName,mapObject.OBJECT_CLASS_NAME=globalDataInteractionObj.utilities.createClassName(mapObject.TAGS),mapObject.OBJECT_TAG_LANG=globalDataInteractionObj.utilities.lang(group_url_title),mapObject.OBJECT_HELP=!0,mapObject.OBJECT_SHOW_INFO=!1,mapObject.OBJECT_SHOW_NAV=!1,mapObject.OBJECT_SHOW_MAPS=!0,mapObject.OBJECT_HELP_TEXT="<p class='text-right btn-close'><span class='glyphicon glyphicon-remove-circle' aria-hidden='true'></span></p>",mapObject.OBJECT_HELP_TEXT+="<p>"+globalDataInteractionObj.utilities.lang("helptextP1")+"</p>",mapObject.OBJECT_HELP_TEXT+="<p>"+globalDataInteractionObj.utilities.lang("helptextP2")+"</p>",mapObject.OBJECT_HELP_TEXT+="<p>"+globalDataInteractionObj.utilities.lang("helptextP3")+"</p>",mapObject.OBJECT_HELP_TEXT+="<p>"+globalDataInteractionObj.utilities.lang("helptextP4")+"</p>",mapObject.OBJECT_HELP_TEXT=globalDataInteractionObj.utilities.escapeXml(mapObject.OBJECT_HELP_TEXT);var elanMapUnlockObjectId=globalDataInteractionObj.mapInteractionHandler.getElanMapUnlockObjectId(),userObjectStatus=globalDataInteractionObj.mapInteractionHandler.getNeighborhoodObjectStatus(elanMapUnlockObjectId);
"undefined"!=userObjectStatus?"locked"!=userObjectStatus&&"open"!=userObjectStatus?mapObject.CALL_TO_ACTION=globalDataInteractionObj.utilities.lang("continueyourjourney"):mapObject.CALL_TO_ACTION=globalDataInteractionObj.utilities.lang("startyourjourney"):mapObject.CALL_TO_ACTION=globalDataInteractionObj.utilities.lang("comingsoon")||"COMING SOON";var userLanguageID=globalDataInteractionObj.objectProperties.apiUserLanguage.id;"undefined"!=userLanguageID&&(1==userLanguageID?(mapObject.NEIGHBORHOOD_TITLE=mapObject.OBJECT_NAME,mapObject.NEIGHBORHOOD_DESC=mapObject.OBJECT_DESCR):6==userLanguageID?(mapObject.NEIGHBORHOOD_TITLE=mapObject.map_zh_Hans_name,mapObject.NEIGHBORHOOD_DESC=mapObject.map_zh_Hans_description?mapObject.map_zh_Hans_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")+"<p> </p>":""):11==userLanguageID?(mapObject.NEIGHBORHOOD_TITLE=mapObject.map_zh_Hant_name,mapObject.NEIGHBORHOOD_DESC=mapObject.map_zh_Hant_description?mapObject.map_zh_Hant_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")+"<p> </p>":""):12==userLanguageID?(mapObject.NEIGHBORHOOD_TITLE=mapObject.map_ja_name,mapObject.NEIGHBORHOOD_DESC=mapObject.map_ja_description?mapObject.map_ja_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")+"<p> </p>":""):13==userLanguageID&&(mapObject.NEIGHBORHOOD_TITLE=mapObject.map_ko_name,mapObject.NEIGHBORHOOD_DESC=mapObject.map_ko_description?mapObject.map_ko_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")+"<p> </p>":""))}return mapObject},findAreaObject:function(areaTagName){var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),areas=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_id","0");if("undefined"==typeof areaTagName||null==areaTagName){var currentArea=globalDataInteractionObj.mapInteractionHandler.currentArea,areaInfo={};areaInfo="undefined"!=typeof currentArea&&null!=currentArea?globalDataInteractionObj.utilities.findOneByProperty(areas,"cat_name",currentArea,"AREA"):globalDataInteractionObj.utilities.sortByProperty(areas,"unlockorder")[0],areaTagName=areaInfo.cat_name,globalDataInteractionObj.mapInteractionHandler.doEventChanges("autoHash",areaInfo.cat_url_title,areaInfo.cat_name)}else var areaInfo=globalDataInteractionObj.utilities.findOneByProperty(areas,"cat_name",areaTagName,"AREA");var areaObject=globalDataInteractionObj.utilities.findMapArea(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,areaTagName),userLanguageID=globalDataInteractionObj.objectProperties.apiUserLanguage.id;return"object"==typeof areaObject&&null!=areaObject&&(areaObject.OBJECT_SHOW_MAPS=!1,areaObject.OBJECT_TAG=areaTagName,areaObject.OBJECT_CLASS_NAME=globalDataInteractionObj.utilities.createClassName(areaObject.TAGS),areaObject.OBJECT_TAG_LANG=globalDataInteractionObj.utilities.lang(areaInfo.cat_url_title),areaObject.OBJECT_HELP=!1,areaObject.OBJECT_SHOW_INFO=!1,areaObject.OBJECT_SHOW_NAV=!1,areaObject.CALL_TO_ACTION="EU"==globalDataInteractionObj.mapInteractionHandler.currentMap?globalDataInteractionObj.utilities.lang("comingsoon")||"COMING SOON":globalDataInteractionObj.utilities.lang("enterneighborhoods"),1==userLanguageID?(areaObject.NEIGHBORHOOD_TITLE=areaObject.OBJECT_NAME,areaObject.NEIGHBORHOOD_DESC=areaObject.OBJECT_DESCR):6==userLanguageID?(areaObject.NEIGHBORHOOD_TITLE=areaObject.map_zh_Hans_name,areaObject.NEIGHBORHOOD_DESC=areaObject.map_zh_Hans_description?areaObject.map_zh_Hans_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")+"<p> </p>":""):11==userLanguageID?(areaObject.NEIGHBORHOOD_TITLE=areaObject.map_zh_Hant_name,areaObject.NEIGHBORHOOD_DESC=areaObject.map_zh_Hant_description?areaObject.map_zh_Hant_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")+"<p> </p>":""):12==userLanguageID?(areaObject.NEIGHBORHOOD_TITLE=areaObject.map_ja_name,areaObject.NEIGHBORHOOD_DESC=areaObject.map_ja_description?areaObject.map_ja_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")+"<p> </p>":""):13==userLanguageID&&(areaObject.NEIGHBORHOOD_TITLE=areaObject.map_ko_name,areaObject.NEIGHBORHOOD_DESC=areaObject.map_ko_description?areaObject.map_ko_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")+"<p> </p>":"")),areaObject},findNeighborhoodObject:function(neighborhoodTagName){var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo();if("EU"!=globalDataInteractionObj.mapInteractionHandler.currentMap){if("undefined"==typeof neighborhoodTagName||null==neighborhoodTagName){var neighborhoods=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_name",globalDataInteractionObj.mapInteractionHandler.currentArea),currentNeighborhood=globalDataInteractionObj.mapInteractionHandler.currentNeighborhood,neighborhoodInfo={};neighborhoodInfo="undefined"!=typeof currentNeighborhood&&null!=currentNeighborhood?globalDataInteractionObj.utilities.findOneByProperty(neighborhoods,"cat_name",currentNeighborhood,"NEIGHBORHOOD"):globalDataInteractionObj.utilities.sortByProperty(neighborhoods,"unlockorder")[0],neighborhoodTagName=neighborhoodInfo.cat_name}else var neighborhoodInfo=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"cat_name",neighborhoodTagName,"NEIGHBORHOOD"),neighborhoods=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_url_title",neighborhoodInfo.parent_url_title);var neighborhoodObject=globalDataInteractionObj.utilities.findMapNeighborhood(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,neighborhoodTagName)}else var neighborhoodObject=globalDataInteractionObj.utilities.findMapArea(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,neighborhoodTagName);var userLanguageID=globalDataInteractionObj.objectProperties.apiUserLanguage.id;return"object"==typeof neighborhoodObject&&null!=neighborhoodObject&&(neighborhoodObject.OBJECT_TAG=neighborhoodTagName,neighborhoodObject.OBJECT_SHOW_MAPS=!1,neighborhoodObject.OBJECT_CLASS_NAME=globalDataInteractionObj.utilities.createClassName(neighborhoodObject.TAGS),neighborhoodObject.LANG_ID=userLanguageID,neighborhoodObject.OBJECT_TAG_LANG=globalDataInteractionObj.utilities.lang(neighborhoodInfo.cat_url_title),neighborhoodObject.OBJECT_HELP=!1,neighborhoodObject.OBJECT_SHOW_INFO=!1,neighborhoodObject.OBJECT_NUMBER_OF_STOPS=neighborhoodInfo.number_of_stops||"",neighborhoodObject.OBJECT_MINUTES_TO_FINISH=neighborhoodInfo.minutes_to_finish||"",""!=neighborhoodObject.OBJECT_NUMBER_OF_STOPS&&""!=neighborhoodObject.OBJECT_MINUTES_TO_FINISH&&(neighborhoodObject.OBJECT_SHOW_INFO=!0,neighborhoodObject.OBJECT_STOPS_IMAGE_CLASS=neighborhoodInfo.parent_url_title,neighborhoodObject.OBJECT_MINUTES_IMAGE_CLASS=neighborhoodInfo.parent_url_title),neighborhoods.length>1?neighborhoodObject.OBJECT_SHOW_NAV=!0:neighborhoodObject.OBJECT_SHOW_NAV=!1,1==userLanguageID?(neighborhoodObject.NEIGHBORHOOD_TITLE=neighborhoodObject.OBJECT_NAME,neighborhoodObject.NEIGHBORHOOD_DESC=neighborhoodObject.OBJECT_DESCR):6==userLanguageID?(neighborhoodObject.NEIGHBORHOOD_TITLE=neighborhoodObject.map_zh_Hans_name,neighborhoodObject.NEIGHBORHOOD_DESC=neighborhoodObject.map_zh_Hans_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")):11==userLanguageID?(neighborhoodObject.NEIGHBORHOOD_TITLE=neighborhoodObject.map_zh_Hant_name,neighborhoodObject.NEIGHBORHOOD_DESC=neighborhoodObject.map_zh_Hant_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")):12==userLanguageID?(neighborhoodObject.NEIGHBORHOOD_TITLE=neighborhoodObject.map_ja_name,neighborhoodObject.NEIGHBORHOOD_DESC=neighborhoodObject.map_ja_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>")):13==userLanguageID&&(neighborhoodObject.NEIGHBORHOOD_TITLE=neighborhoodObject.map_ko_name,neighborhoodObject.NEIGHBORHOOD_DESC=neighborhoodObject.map_ko_description.replace(/\*\*\*/g,"<br/><br/>").replace(/\<\</g,"<i>").replace(/\>\>/g,"</i>"))),neighborhoodObject},setObjectPin:function(){if(jQuery("#vmap svg").length>0){var neighborhoodPins=$.extend({},globalDataInteractionObj.mapInteractionHandler.getPins());if("NEIGHBORHOOD"==globalDataInteractionObj.mapInteractionHandler.currentMapObject.OBJECT_LEVEL){var currentNeighborhood=globalDataInteractionObj.mapInteractionHandler.currentNeighborhood,currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),currentNeighborhoodInfo=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"cat_name",currentNeighborhood,"NEIGHBORHOOD"),pinImageName="pin-select-"+currentNeighborhoodInfo.parent_url_title+".png",pingImagePath=globalDataInteractionObj.objectProperties.appRoot+"images/marker/"+pinImageName,pinContent="<div class='map-pin'><span class='pin-img' ";pinContent+="style=\"background-image: url('"+pingImagePath+"')\"",pinContent+=">",pinContent+="</span></div>",neighborhoodPins[currentNeighborhoodInfo.cat_url_title]=pinContent}globalDataInteractionObj.mapInteractionHandler.displayPins(neighborhoodPins)}},displayPins:function(neighborhoodPins){"undefined"==typeof neighborhoodPins&&(neighborhoodPins=globalDataInteractionObj.mapInteractionHandler.getPins()),globalDataInteractionObj.mapInteractionHandler.currentJQVMapObject.placePins(neighborhoodPins,"content")},displayObjectInfo:function(objectLevel,objectInfo){globalDataInteractionObj.mapInteractionHandler.setCurrentObject(objectLevel,objectInfo),globalDataInteractionObj.handlebarsUtils.setTemplates("map-info-template",objectInfo),$('[data-toggle="popover"]').popover({container:"body"}),$('[data-toggle="popover"]').on("shown.bs.popover",function(){$(".popover-content .btn-close span").on("click",function(){$('[data-toggle="popover"]').popover("hide")})}),globalDataInteractionObj.mapInteractionHandler.setContentHeight(),globalDataInteractionObj.mapInteractionHandler.setObjectPin()},displayMapData:function(mapTagName){var mapObject=globalDataInteractionObj.mapInteractionHandler.findMapObject(mapTagName);"object"==typeof mapObject&&null!=mapObject&&(globalDataInteractionObj.mapInteractionHandler.currentMap=mapObject.OBJECT_TAG,globalDataInteractionObj.mapInteractionHandler.displayObjectInfo("MAP",mapObject),$("a#mapCallToAction").click(function(){var currentArea=globalDataInteractionObj.mapInteractionHandler.currentArea,currentNeighborhood=globalDataInteractionObj.mapInteractionHandler.currentNeighborhood;if("undefined"!=typeof currentArea&&null!=currentArea&&"undefined"!=typeof currentNeighborhood&&null!=currentNeighborhood){var currentAreaObject=globalDataInteractionObj.mapInteractionHandler.findAreaObject();globalDataInteractionObj.mapInteractionHandler.currentAreaObjectId=currentAreaObject.OBJECT_ID,globalDataInteractionObj.mapInteractionHandler.displayNeighborhoodData(currentNeighborhood)}else globalDataInteractionObj.mapInteractionHandler.displayAreaData(mapTagName)}))},displayAreaData:function(areaTagName){$('[data-toggle="popover"]').popover("hide");var areaObject=globalDataInteractionObj.mapInteractionHandler.findAreaObject(areaTagName);if("object"==typeof areaObject&&null!=areaObject){globalDataInteractionObj.mapInteractionHandler.currentArea=areaObject.OBJECT_TAG;var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),neighborhoods=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_name",areaObject.OBJECT_TAG);1==neighborhoods.length?(globalDataInteractionObj.mapInteractionHandler.currentAreaObjectId=areaObject.OBJECT_ID,globalDataInteractionObj.mapInteractionHandler.displayNeighborhoodData()):(location.hash="journey|"+areaObject.OBJECT_TAG,globalDataInteractionObj.mapInteractionHandler.displayObjectInfo("AREA",areaObject),$("a#mapCallToAction").click(function(){globalDataInteractionObj.mapInteractionHandler.displayNeighborhoodData()}))}},displayNeighborhoodData:function(neighborhoodTagName){if("EU"==globalDataInteractionObj.mapInteractionHandler.currentMap)globalDataInteractionObj.utilities.launchNeighborhoodCourse(globalDataInteractionObj.mapInteractionHandler.currentAreaObjectId);else{var neighborhoodObject=globalDataInteractionObj.mapInteractionHandler.findNeighborhoodObject(neighborhoodTagName);if("object"==typeof neighborhoodObject&&null!=neighborhoodObject){location.hash="journey|"+globalDataInteractionObj.mapInteractionHandler.currentArea+"|"+neighborhoodObject.OBJECT_TAG,globalDataInteractionObj.mapInteractionHandler.currentNeighborhood=neighborhoodObject.OBJECT_TAG;var userObjectStatus="";if("138"==neighborhoodObject.OBJECT_ID)userObjectStatus="open";else var userObjectStatus=globalDataInteractionObj.mapInteractionHandler.getNeighborhoodObjectStatus(neighborhoodObject.OBJECT_ID);globalDataInteractionObj.objectProperties.apiUserLanguage.id;"locked"==userObjectStatus?neighborhoodObject.CALL_TO_ACTION=globalDataInteractionObj.utilities.lang("locked"):neighborhoodObject.CALL_TO_ACTION=globalDataInteractionObj.utilities.lang("experience"),globalDataInteractionObj.mapInteractionHandler.displayObjectInfo("NEIGHBORHOOD",neighborhoodObject),"locked"!=userObjectStatus&&$("a#mapCallToAction").click(function(){$("a#mapCallToAction").css("pointer-events","none"),globalDataInteractionObj.utilities.launchNeighborhoodCourse()}),$("a#btn-previous").click(function(){globalDataInteractionObj.mapInteractionHandler.previousNeighborhood()}),$("a#btn-next").click(function(){globalDataInteractionObj.mapInteractionHandler.nextNeighborhood()})}}},previousNeighborhood:function(){var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),currentArea=globalDataInteractionObj.mapInteractionHandler.currentArea,currentNeighborhood=globalDataInteractionObj.mapInteractionHandler.currentNeighborhood,neighborhoods=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_name",currentArea);neighborhoods=globalDataInteractionObj.utilities.sortByProperty(neighborhoods,"unlockorder");var currentIndex=globalDataInteractionObj.utilities.findIndexByProperty(neighborhoods,"cat_name",currentNeighborhood),previousIndex=currentIndex-1;0>previousIndex&&(previousIndex=neighborhoods.length-1);var neighborhoodTagName=neighborhoods[previousIndex].cat_name;globalDataInteractionObj.mapInteractionHandler.displayNeighborhoodData(neighborhoodTagName)},nextNeighborhood:function(){var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),currentArea=globalDataInteractionObj.mapInteractionHandler.currentArea,currentNeighborhood=globalDataInteractionObj.mapInteractionHandler.currentNeighborhood,neighborhoods=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_name",currentArea);neighborhoods=globalDataInteractionObj.utilities.sortByProperty(neighborhoods,"unlockorder");var currentIndex=globalDataInteractionObj.utilities.findIndexByProperty(neighborhoods,"cat_name",currentNeighborhood),nextIndex=currentIndex+1;nextIndex==neighborhoods.length&&(nextIndex=0);var neighborhoodTagName=neighborhoods[nextIndex].cat_name;globalDataInteractionObj.mapInteractionHandler.displayNeighborhoodData(neighborhoodTagName)},displayCurrentData:function(){var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),currentMap=globalDataInteractionObj.mapInteractionHandler.currentMap,currentArea=globalDataInteractionObj.mapInteractionHandler.currentArea,currentNeighborhood=globalDataInteractionObj.mapInteractionHandler.currentNeighborhood;if(globalDataInteractionObj.mapInteractionHandler.displayMapData(currentMap),"undefined"!=typeof currentArea&&null!=currentArea&&globalDataInteractionObj.mapInteractionHandler.displayAreaData(currentArea),"undefined"!=typeof currentNeighborhood&&null!=currentNeighborhood&&globalDataInteractionObj.mapInteractionHandler.displayNeighborhoodData(currentNeighborhood),globalDataInteractionObj.mapInteractionHandler.setLegends(),globalDataInteractionObj.mapInteractionHandler.loadMap(),"undefined"!=typeof currentNeighborhood&&null!=currentNeighborhood){var neighborhoodInfo=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"cat_name",currentNeighborhood,"NEIGHBORHOOD");globalDataInteractionObj.mapInteractionHandler.doEventChanges("autoHash",neighborhoodInfo.parent_url_title,neighborhoodInfo.parent_name),globalDataInteractionObj.mapInteractionHandler.setObjectPin()}else if("undefined"!=typeof currentArea&&null!=currentArea){var areaInfo=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"cat_name",currentArea,"AREA");globalDataInteractionObj.mapInteractionHandler.doEventChanges("autoHash",areaInfo.cat_url_title,areaInfo.cat_name)}},doEventChanges:function(eventType,code,region){if("regionMouseOut"==eventType){var selectedColors=globalDataInteractionObj.mapInteractionHandler.getSelectedColors();jQuery("#vmap").vectorMap("set","colors",selectedColors)}else{var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),areaInfo=null;if("autoHash"==eventType)areaInfo=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"cat_url_title",code,"AREA"),globalDataInteractionObj.mapInteractionHandler.currentArea=areaInfo.cat_name;else if("EU"==globalDataInteractionObj.mapInteractionHandler.currentMap&&"regionClick"==eventType)areaInfo=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"cat_url_title",code,"AREA"),console.log("doEventChanges regionClick",areaInfo),globalDataInteractionObj.mapInteractionHandler.currentArea=areaInfo.cat_name;else{var neighborhoodInfo=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"cat_url_title",code,"NEIGHBORHOOD");"undefined"!=typeof neighborhoodInfo&&null!=neighborhoodInfo&&(areaInfo=globalDataInteractionObj.utilities.findOneByProperty(currentMapInfo,"cat_url_title",neighborhoodInfo.parent_url_title,"AREA"))}if("undefined"!=typeof areaInfo&&null!=areaInfo){var neighborhoods=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_url_title",areaInfo.cat_url_title),selectedNeighborhoods=[];$.each(neighborhoods,function(nkey,nvalue){selectedNeighborhoods.push(nvalue.cat_url_title)}),"autoHash"==eventType?(globalDataInteractionObj.mapInteractionHandler.displayLegend(areaInfo.cat_url_title),globalDataInteractionObj.mapInteractionHandler.setRegionBorderColors(eventType,areaInfo.cat_url_title),globalDataInteractionObj.mapInteractionHandler.setRegionColors(eventType,areaInfo.cat_url_title,selectedNeighborhoods,currentMapInfo)):"regionClick"==eventType&&(globalDataInteractionObj.mapInteractionHandler.displayLegend(areaInfo.cat_url_title),globalDataInteractionObj.mapInteractionHandler.currentNeighborhood=null,globalDataInteractionObj.mapInteractionHandler.displayAreaData(areaInfo.cat_name),globalDataInteractionObj.mapInteractionHandler.setRegionBorderColors(eventType,areaInfo.cat_url_title),globalDataInteractionObj.mapInteractionHandler.setRegionColors(eventType,areaInfo.cat_url_title,selectedNeighborhoods,currentMapInfo))}}},displayAdditionalContent:function(mapObject){var additionalContent=globalDataInteractionObj.mapInteractionHandler.getAdditionalContent();additionalContent&&$.each(additionalContent,function(key,contentObj){var text=document.createElementNS("http://www.w3.org/2000/svg","text");text.setAttribute("transform",contentObj.transform),$.each(contentObj.content,function(cindex,cvalue){var node=document.createElementNS("http://www.w3.org/2000/svg","tspan");node.setAttribute("x",cvalue.x),node.setAttribute("y",cvalue.y),node.setAttribute("class",cvalue["class"]),node.textContent=cvalue.text,contentObj.hasOwnProperty("region")&&(node.setAttribute("id",mapObject.getCountryId(contentObj.region)+"_text"+cindex),node.setAttribute("color","currentColor"),node.onclick=function(){var temp=$(this).attr("id").split("_");temp.pop(),temp=temp.join("_"),$("#"+temp).trigger("click"),console.log("clicked "+temp)}),text.appendChild(node)}),jQuery("#vmap svg g").append(text)})},getMapInfo:function(){return globalDataInteractionObj.userData.userMapHandler.mapInfo},getElanMapObjectId:function(){return globalDataInteractionObj.userData.userMapHandler.elanMapObjectId},setElanMapObjectId:function(){globalDataInteractionObj.userData.userMapHandler.elanMapObjectId=0;var mapTagName=globalDataInteractionObj.userData.userMapHandler.elanMapObjectIdTag,mapObject=globalDataInteractionObj.utilities.findJourneyMap(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,mapTagName);"undefined"!=typeof mapObject&&null!=mapObject&&(globalDataInteractionObj.userData.userMapHandler.elanMapObjectId=mapObject.OBJECT_ID)},getElanMapUnlockObjectId:function(){return globalDataInteractionObj.userData.userMapHandler.elanMapUnlockObjectId},setElanMapUnlockObjectId:function(){globalDataInteractionObj.userData.userMapHandler.elanMapUnlockObjectId=0;var neighborhoodTagName=globalDataInteractionObj.userData.userMapHandler.elanMapUnlockObjectIdTag,neighborhoodObject=globalDataInteractionObj.utilities.findMapNeighborhood(globalDataInteractionObj.mapInteractionHandler.mapLearningObjects,neighborhoodTagName);"undefined"!=typeof neighborhoodObject&&null!=neighborhoodObject&&(globalDataInteractionObj.userData.userMapHandler.elanMapUnlockObjectId=neighborhoodObject.OBJECT_ID)},getOriginalColors:function(){return globalDataInteractionObj.userData.userMapHandler.originalColors},getDarkColors:function(){return globalDataInteractionObj.userData.userMapHandler.darkColors},getPins:function(){return $.each(globalDataInteractionObj.userData.userMapHandler.pins,function(key,value){globalDataInteractionObj.userData.userMapHandler.pins[key]=globalDataInteractionObj.utilities.escapeXml(value)}),globalDataInteractionObj.userData.userMapHandler.pins},setPin:function(key,value){globalDataInteractionObj.userData.userMapHandler.pins[key]=globalDataInteractionObj.utilities.escapeXml(value)},setLegends:function(){var currentMapInfo=globalDataInteractionObj.mapInteractionHandler.getMapInfo(),areas=globalDataInteractionObj.utilities.findAllByProperty(currentMapInfo,"parent_id","0");areas=globalDataInteractionObj.utilities.sortByProperty(areas,"unlockorder"),$.each(areas,function(akey,avalue){var liElement='<li class="'+avalue.cat_url_title+'" data-title="'+globalDataInteractionObj.utilities.lang(avalue.cat_url_title)+'"></li>';$("ul.legend-group").append(liElement)})},displayLegend:function(area){$("ul.legend-group li").removeClass("active"),"undefined"!=typeof area&&$("ul.legend-group li."+area).addClass("active")},getAdditionalContent:function(){return globalDataInteractionObj.userData.userMapHandler.additionalContent},getSelectedColors:function(){return globalDataInteractionObj.userData.userMapHandler.selectedColors},setSelectedColors:function(selectedColors){globalDataInteractionObj.userData.userMapHandler.selectedColors=selectedColors},setRegionBorderColors:function(eventType,selectedArea){var newColors=globalDataInteractionObj.userData.userMapHandler.getRegionBorderColors(selectedArea);jQuery("#vmap").vectorMap("set","colors",newColors),("regionClick"==eventType||"autoHash"==eventType)&&globalDataInteractionObj.mapInteractionHandler.setSelectedColors(newColors)},setRegionColors:function(eventType,selectedArea,selectedNeighborhoods,colorToNeighborhoods){var selectedColors=globalDataInteractionObj.mapInteractionHandler.getSelectedColors(),originalColors=globalDataInteractionObj.mapInteractionHandler.getOriginalColors(),darkColors=globalDataInteractionObj.mapInteractionHandler.getDarkColors(),newColors=$.extend({},selectedColors);$.each(colorToNeighborhoods,function(key,value){if(0!=value.parent_id){var name=value.cat_url_title;-1!=jQuery.inArray(name,selectedNeighborhoods)?newColors[name]=originalColors[name]:newColors[name]=darkColors[name]}}),jQuery("#vmap").vectorMap("set","colors",newColors),("regionClick"==eventType||"autoHash"==eventType)&&globalDataInteractionObj.mapInteractionHandler.setSelectedColors(newColors)},loadMap:function(){var is_iPad=globalDataInteractionObj.objectProperties.isIPad;freshMapObject&&"function"==typeof freshMapObject.reset&&!globalDataInteractionObj.isMapLoaded&&(freshMapObject.reset(),console.log("*********************** refresh map ***********************"));var mapDiv=jQuery("#vmap");freshMapObject=mapDiv.vectorMap({map:globalDataInteractionObj.userData.userMapHandler.mapJavaScriptId,backgroundColor:"#F3F2EA",colors:globalDataInteractionObj.mapInteractionHandler.getOriginalColors(),enableZoom:!is_iPad,showTooltip:!1,showLabels:!1,regionSelectable:!1,hoverOpacity:1,series:{countries:[{attribute:"transform"}],regions:[{attribute:"fill"}]},pins:{},pinMode:"content",onLoad:function(event,map){globalDataInteractionObj.isMapLoaded||(globalDataInteractionObj.isMapLoaded=!0,globalDataInteractionObj.mapInteractionHandler.currentJQVMapObject=map,globalDataInteractionObj.mapInteractionHandler.displayAdditionalContent(map),globalDataInteractionObj.mapInteractionHandler.getNeighborhoodObjectStatus(),globalDataInteractionObj.userData.displayTargetArrival(),globalDataInteractionObj.userData.displayNextDestination(),globalDataInteractionObj.userData.displayPassportStamps(),globalDataInteractionObj.userData.displayJourneyAccordion(),globalDataInteractionObj.userData.myProfileTabEventHandler(),globalDataInteractionObj.userData.getJourneyVideo())},onRegionOver:function(event,code,region){},onRegionOut:function(event,code,region){},onRegionClick:function(event,code,region){event.preventDefault(),console.log("onRegionClick - "+event.type+"-"+code+" - "+region),globalDataInteractionObj.mapInteractionHandler.doEventChanges(event.type,code,region)},onResize:function(event,width,height){setTimeout(function(){globalDataInteractionObj.mapInteractionHandler.setObjectPin()},200)}})},wireMapButtons:function(){$("body").on("click",".nyc",function(e){e.preventDefault(),"nyc"!=globalDataInteractionObj.userData.mlRankMap()&&(location.hash="journey",globalDataInteractionObj.isMapLoaded=!1,globalDataInteractionObj.ajaxUtilities.ajaxLauncher("mapsetup","mlapprentice"))}),$("body").on("click",".europe",function(e){e.preventDefault(),"eu"!=globalDataInteractionObj.userData.mlRankMap()&&(location.hash="journey|europe",globalDataInteractionObj.isMapLoaded=!1,globalDataInteractionObj.ajaxUtilities.ajaxLauncher("mapsetup","eu"))})},resetMap:function(){location.hash="journey",globalDataInteractionObj.isMapLoaded=!1,globalDataInteractionObj.ajaxUtilities.ajaxLauncher("mapsetup","mlapprentice"),globalDataInteractionObj.mapInteractionHandler.wireMapButtons()},resetMapThen:function(){var mapObject=globalDataInteractionObj.mapInteractionHandler.currentJQVMapObject;"function"==typeof mapObject.reset&&mapObject.reset(),mapObject.zoomCurStep=1,globalDataInteractionObj.mapInteractionHandler.currentArea=null,globalDataInteractionObj.mapInteractionHandler.currentNeighborhood=null,globalDataInteractionObj.mapInteractionHandler.displayLegend();var originalColors=globalDataInteractionObj.mapInteractionHandler.getOriginalColors();globalDataInteractionObj.mapInteractionHandler.setSelectedColors(originalColors)},mapDataInit:function(){globalDataInteractionObj.mapInteractionHandler.fetchMapLearningObjects()},mapInit:function(){console.log("mapInit"),globalDataInteractionObj.mapInteractionHandler.currentMap=globalDataInteractionObj.userData.userMapHandler.elanMapTag,globalDataInteractionObj.mapInteractionHandler.loadSlideOutPanel()}},init:function(){""!=member_profile_data.elan_user_id&&(this.userData.displayMeterCompletions(),this.userData.userInit())},update:function(){this.userData.userUpdate()}},idleTime=0;$(document).ready(function(){$(".language-modal").hide(),globalDataInteractionObj.utilities.setAllowedLanguages("language-model-list"),$(".translator-icon").click(function(){$(".language-modal").show(),$(".language-modal").unbind().click(function(e){($(e.target).hasClass("icon-close-btn")||!$(e.target).parents(".language-modal").length)&&$(".language-modal").hide()}),$(".change-language").unbind().click(function(e){var language_id=$(this).attr("attr-lang-id"),language_abbr=$(this).attr("attr-lang-abbr");$("#change-lang-hidden-input").val(language_abbr);var parameters={type:"updateuserlanguageid",language_id:language_id};$.ajax(globalDataInteractionObj.ajaxUtilities.ajaxSwitch("GET",parameters,"api")).done(function(response){$("form.change-language-form").submit()})})}),g2="undefined"!=typeof JustGage?new JustGage({id:"g2",min:0,max:22,relativeGaugeSize:!0,gaugeColor:"#50B586",hideMinMax:!0,pointer:!0,hideValue:!0,pointerOptions:{toplength:-30,bottomlength:50,bottomwidth:6,color:"#50B586",stroke_linecap:"round"},customSectors:[{color:"#C6F1DD",lo:0,hi:4},{color:"#99E0BF",lo:4,hi:12},{color:"#77CFA6",lo:12,hi:16},{color:"#50B586",lo:16,hi:22}],levelColorsGradient:!1,gaugeWidthScale:.8,counter:!1,parseTime:!1}):{},idleInterval&&clearInterval(idleInterval),idleInterval=setInterval(timerIncrement,6e4),this.addEventListener("mousemove",resetTimer,!1),this.addEventListener("mousedown",resetTimer,!1),this.addEventListener("keypress",resetTimer,!1),this.addEventListener("DOMMouseScroll",resetTimer,!1),this.addEventListener("mousewheel",resetTimer,!1),this.addEventListener("touchmove",resetTimer,!1),this.addEventListener("MSPointerMove",resetTimer,!1)}),$(function(){globalDataInteractionObj.init(),function(){function toggleMenu(state,timing){menuClosed=!menuClosed,menuClosed?body.removeClass("no-scroll"):body.addClass("no-scroll"),userMenu.toggle(),$("#menu-dimmer").toggle()}function reviewAnswer(){$(".quiz-container .quiz-questions").hide(),$(".quiz-container .quiz-results").hide();var current_question_no=$(".quiz-container .quiz-review #current_question_no").val();$(".quiz-container .quiz-review .question").hide(),$(".quiz-container .quiz-review .question"+current_question_no).show(),$("span.user-answer").html(quiz.answers[current_question_no-1]),current_question_no==quiz.data.DATA.length&&($(".quiz-container .quiz-review button.next").hide(),$(".quiz-container .quiz-review .review-end").show()),$(".quiz-container .quiz-review").show()}function gradeQuiz(pass_percent,object_id,parent_id){var correct=0,question_count=1,record_id=$("#quiz_record_id").val(),pass="Failed";quiz.answers.forEach(function(answer){1==quiz.data.DATA[question_count-1].ANSWERS[answer-1].CORRECT&&correct++,question_count++,globalDataInteractionObj.ajaxUtilities.ajaxLauncher("submitquizanswers",record_id,answer,question_count-1)}),question_count--;var user_percent=Math.round(100*(correct/question_count).toFixed());if(user_percent>=pass_percent){pass="Passed";var quiz_results_html=globalDataInteractionObj.utilities.lang("congratulations")+"<p>"+globalDataInteractionObj.utilities.lang("passed_assessment")+"</p>";quiz_results_html+="<br/><p>"+globalDataInteractionObj.utilities.lang("review_answer_text")+"</p>",quiz_results_html+='<button id="reviewanswers" class="btn btn-default">'+globalDataInteractionObj.utilities.lang("review_answers")+"</button>",$(".quiz-container .quiz-results").html(quiz_results_html),$(".quiz-container .quiz-results #reviewanswers").on("click",function(e){e.preventDefault,$(".quiz-review #current_question_no").val(1),reviewAnswer()}),$(".quiz-container .quiz-review button.next").on("click",function(e){e.stopImmediatePropagation(),e.preventDefault;var current_question_no=$(".quiz-review #current_question_no").val();current_question_no=parseInt(current_question_no)+1,$(".quiz-review #current_question_no").val(current_question_no),reviewAnswer()}),$("#svg-"+parent_id).html(user_percent+"%"),$(".svg-"+parent_id).show(),globalDataInteractionObj.ajaxUtilities.removeDisableClassForNextChild(object_id,parent_id);var passed=0;for(var row_key in globalDataInteractionObj.objectProperties.rawAjaxCourseData)for(var object_key in globalDataInteractionObj.objectProperties.rawAjaxCourseData[row_key])globalDataInteractionObj.objectProperties.rawAjaxCourseData[row_key][object_key].course_id==parent_id&&(globalDataInteractionObj.objectProperties.rawAjaxCourseData[row_key][object_key].course_percent=user_percent+"%"),
""!=globalDataInteractionObj.objectProperties.rawAjaxCourseData[row_key][object_key].course_percent&&passed++;globalDataInteractionObj.objectProperties.rawAjaxCourseData.passed_assessments=passed;var percent_done=Math.round(passed/globalDataInteractionObj.objectProperties.rawAjaxCourseData.total_assessments*100);$(".data-course-completion").text(percent_done+"%")}else $(".quiz-container .quiz-results").html(globalDataInteractionObj.utilities.lang("failed_assessment")+".  "+globalDataInteractionObj.utilities.lang("min_passing_score")+" "+pass_percent+"%.  "+globalDataInteractionObj.utilities.lang("review_and_retake")+".");$(".quiz-container .question").hide(),$(".quiz-container .quiz-results").show(),globalDataInteractionObj.ajaxUtilities.ajaxLauncher("updateuserobjectrecord",record_id,pass,user_percent)}window.location.hash="";var body=$("body"),userMenu=$("#off-canvas-menu"),menuDimmer=$("#menu-dimmer"),menuClosed=!0;!function pageRoutes(){var navLinks=$("a.coach-nav-link"),pageTransition=new TimelineLite,allSections=$(".full-page-section");$("#preloader");TweenLite.to(allSections.not(".activestate"),.01,{x:700}),allSections.not(".activestate").hide(),navLinks.on("click touchstart",function(e){e.preventDefault();var $this=$(this).parent("li"),destinationPath=this.pathname.split("/").slice(-1)[0],destination=$("#"+destinationPath);if($this.hasClass("activestate")){if("mapJourney"==destinationPath)if(console.log("+++++++++++ click mapJourney currentMap"+globalDataInteractionObj.mapInteractionHandler.currentMap),""==globalDataInteractionObj.mapInteractionHandler.currentMap)window.location.hash="",globalDataInteractionObj.mapInteractionHandler.resetMap();else{var mapTag=globalDataInteractionObj.mapInteractionHandler.currentMap.replace(" ","").toLowerCase();location.hash="mlapprentice"==mapTag?"journey":"journey|"+mapTag,globalDataInteractionObj.isMapLoaded=!1,globalDataInteractionObj.ajaxUtilities.ajaxLauncher("mapsetup",mapTag)}}else{$(".fade-in-trigger").removeClass("fade-in-trigger");var currentPage=$(".full-page-section.activestate");pageTransition.to(currentPage,.65,{x:-700,autoAlpha:0,ease:"Expo.easeIn"}).to(currentPage,.01,{x:700,onComplete:function(){currentPage.hide(),body.attr("data-page",destinationPath),$(window).scrollTop(0),navLinks.parents("li").add(allSections).removeClass("activestate"),$this.add(destination).addClass("activestate"),destination.show(1,function(){$this.css("pointer-events","auto"),$(window).trigger("resize")})}}).to(destination,.65,{x:0,autoAlpha:1,ease:"Expo.easeOut",onComplete:function(){console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> transition to "+destination.attr("id")),"mapJourney"==destination.attr("id")?(globalDataInteractionObj.mapInteractionHandler.resetMap(),$(window).trigger("resize")):"myProfileBlock"==destination.attr("id")&&(console.log("Update data on profile page"),globalDataInteractionObj.ajaxUtilities.ajaxLauncher("profilesetup"))}})}})}(),function slideMenu(){userMenu.hide(),$(".menu-burger").on("click",function(){menuClosed?toggleMenu("open",.65):toggleMenu("close",.65)}),menuDimmer.add("#off-canvas-menu .icon-menu-cross").on("click touchstart",function(){toggleMenu("close",.4)}),$(window).on("resize.userMenu",function(){menuClosed||toggleMenu("close",.01)})}(),function videoPlayer(){$("body").on("click touchstart",".play-video",function(e){if(!$(this).hasClass("disabled")){e.preventDefault();var record_id=$(this).attr("attr-record-id"),parent_object_id=$(this).attr("attr-parent"),object_id=$(this).attr("id"),step_num=1;$("div.pre-load-modal").fadeIn(300),globalDataInteractionObj.ajaxUtilities.ajaxLauncher("getcoursevideo",record_id,parent_object_id,object_id,step_num)}}),$("body").on("tap",function(){player.userActive()===!0?player.userActive(!1):player.userActive(!0)})}(),function pdfModal(){globalDataInteractionObj.utilities.getCookie("exp_elan_username");$("body").on("click touchstart","ul li a.Link",function(e){e.preventDefault();var theSrc,windowHandle,modal=$("#pdf-modal"),preloader=$("#pdf-preloader"),parent_id=$(this).attr("attr-parent"),object_id=$(this).attr("id"),theHref=this.href,country_code=globalDataInteractionObj.utilities.getCountryCode(),currentUserName=(globalDataInteractionObj.utilities.getLocationIP(),globalDataInteractionObj.utilities.getCookie("exp_elan_username"));$(this).hasClass("disabled")||(theHref=theHref.replace("http:/","https:/"),"CN"==country_code||"sumanafazalretail"==currentUserName||"joonretail1"==currentUserName||"116.50.57.180"==locationIP?(windowHandle=window.open("","pdfTab","status=1"),"undefined"==typeof windowHandle||windowHandle.closed?(windowHandle.document.location.href=theHref,windowHandle.focus()):(windowHandle.close(),windowHandle=window.open("","pdfTab","status=1"),windowHandle.location.href=theHref,windowHandle.focus()),globalDataInteractionObj.ajaxUtilities.ajaxLauncher("updatecreateuserrecord",object_id,parent_id,"Complete")):-1==theHref.indexOf("stylegame.coach.com")&&"CN"!=country_code?(console.log("Country - "+country_code),theSrc=window.innerWidth<1025?"https://drive.google.com/viewerng/viewer?embedded=true&url="+theHref:theHref,modal.find("iframe").attr("src",theSrc),preloader.show(),modal.fadeIn(300),$("body").addClass("modal-open")):(theSrc=theHref,modal.find("iframe").attr("src",theSrc),preloader.show(),modal.fadeIn(300),$("body").addClass("modal-open")),globalDataInteractionObj.ajaxUtilities.ajaxLauncher("updatecreateuserrecord",object_id,parent_id,"Complete"),monthly_focus.child=!0),$("body").on("click touchstart",".course-detail .icon-close-btn",function(){modal.fadeOut(300,function(){$("div.course-detail").html(""),monthly_focus.child=!1,$("body").removeClass("modal-open")})}),$("body").on("click touchstart",".logout-link",function(e){var windowHandle=window.open(theHref,"pdfTab","status=1");windowHandle.close()}),modal.add("close-button").on("click touchstart",function(){modal.fadeOut(300,function(){monthly_focus.child=!1,modal.find("iframe").attr("src",""),$("body").removeClass("modal-open")})}),$("iframe").on("load",function(){preloader.fadeOut(100)})}),$("body").on("click touchstart","ul li a.Quiz",function(e){if(e.preventDefault(),!$(this).hasClass("disabled")){$("div.pre-load-modal").fadeIn(300);var modal=$("div.quiz-container");modal.width($(".test-size").width());var parent_id=$(this).attr("attr-parent"),object_id=$(this).attr("id"),count=1,answers=[],pass_percent=$(this).attr("attr-quiz-percent");monthly_focus.child=!0;$("#quiz_record_id").val();globalDataInteractionObj.ajaxUtilities.fillQuizQuestions(object_id,parent_id),modal.fadeIn(500)}$("body").on("click touchstart",".quiz-container .icon-close-btn",function(){modal.fadeOut(300,function(){$("div.quiz-container").html(""),monthly_focus.child=!1,$("body").removeClass("modal-open")})}),$("body").on("click touchstart",".quiz-container .question .user-answer",function(){if($("input[name='"+count+"']").is(":checked")){var input_value=$("input[name='"+count+"']:checked").val();$("#selected-ans-correct").is(".correct-ans")&&$(".correct-ans-"+count+"-"+input_value+" .correct-ans").show(),$("#selected-ans-incorrect").is(".incorrect-ans")&&$(".correct-ans-"+count+"-"+input_value+" .incorrect-ans").show(),$("input[name='"+count+"']").attr("disabled",!0)}});var quizflag=!1;$("body").on("click touchstart",".quiz-container .quiz-questions .next",function(e){e.preventDefault,quizflag||($(".quiz-container .errormsg").hide(),$("input[name='"+count+"']").is(":checked")?(answers.push($("input[name='"+count+"']:checked").val()),count<quiz.data.DATA.length?setTimeout(function(){$(".quiz-container .question"+count).hide(),count++,$(".quiz-container .question"+count).show()},250):(quiz.answers=answers,answers=[],gradeQuiz(pass_percent,object_id,parent_id))):$(".quiz-container .errormsg").show(),quizflag=!0,setTimeout(function(){quizflag=!1},450))})}),$("body").on("click touchstart","ul li a.SCORM",function(e){if(e.preventDefault(),!$(this).hasClass("disabled")){var parent_id=$(this).attr("attr-parent"),object_id=$(this).attr("id");globalDataInteractionObj.utilities.launchMonthlyFocusCourse(object_id,parent_id)}globalDataInteractionObj.ajaxUtilities.removeDisableClassForNextChild(object_id,parent_id)})}()}()});
//# sourceMappingURL=js/coach.js.map